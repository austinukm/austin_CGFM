2025-11-23 12:30:00,820 | INFO | Logging to: logs\cgfm_no_inter\train_20251123_123000.log
2025-11-23 12:30:00,820 | INFO | Using device: cuda
2025-11-23 12:30:00,821 | INFO | Arguments: {'train_csv': 'data\\train_val_test_dir\\train.csv', 'val_csv': 'data\\train_val_test_dir\\val.csv', 'all_csv': 'data\\train_val_test_dir\\all_ratings.csv', 'text_features': 'feature_output\\movie_text_features_20251103_1457.npz', 'img_features': 'feature_output\\movie_img_features_20251103_1457.npz', 'batch_size': 64, 'epochs': 30, 'lr': 0.0005, 'user_emb_dim': 64, 'proj_hidden_dim': 512, 'proj_dim': 512, 'vector_gate': False, 'lambda_contrast': 0.1, 'topk': [5, 10, 20], 'sample_neg': 100, 'topk_max_users': 0, 'no_scheduler': False, 'log_name': 'cgfm_no_inter', 'device': None, 'no_gate': False, 'no_sim': False, 'no_interaction': True}
2025-11-23 12:32:12,143 | INFO | Epoch 01 | Loss: 1.6590 (Rec: 1.2523, Con: 4.0677) | Val AUC: 0.7289 | Gate Mean: 0.4708 (Std: 0.0005) | Precision@5: 0.2454 | Recall@5: 0.1710 | NDCG@5: 0.2798 | Hit@5: 0.5855 | Precision@10: 0.2133 | Recall@10: 0.2853 | NDCG@10: 0.2995 | Hit@10: 0.7087 | Precision@20: 0.1720 | Recall@20: 0.4349 | NDCG@20: 0.3400 | Hit@20: 0.8082 | MAP: 0.2633 | MRR: 0.4259
2025-11-23 12:32:12,161 | INFO | Saved best model to model\best_model_cgfm_no_inter.pth
2025-11-23 12:34:22,598 | INFO | Epoch 02 | Loss: 0.6540 (Rec: 0.5670, Con: 0.8694) | Val AUC: 0.7840 | Gate Mean: 0.0046 (Std: 0.0010) | Precision@5: 0.2382 | Recall@5: 0.1673 | NDCG@5: 0.2675 | Hit@5: 0.5656 | Precision@10: 0.2125 | Recall@10: 0.2863 | NDCG@10: 0.2931 | Hit@10: 0.6971 | Precision@20: 0.1800 | Recall@20: 0.4518 | NDCG@20: 0.3436 | Hit@20: 0.8136 | MAP: 0.2699 | MRR: 0.4038
2025-11-23 12:34:22,616 | INFO | Saved best model to model\best_model_cgfm_no_inter.pth
2025-11-23 12:36:31,640 | INFO | Epoch 03 | Loss: 0.5235 (Rec: 0.5155, Con: 0.0800) | Val AUC: 0.7938 | Gate Mean: 0.0250 (Std: 0.0036) | Precision@5: 0.2696 | Recall@5: 0.1951 | NDCG@5: 0.3065 | Hit@5: 0.6224 | Precision@10: 0.2394 | Recall@10: 0.3222 | NDCG@10: 0.3337 | Hit@10: 0.7449 | Precision@20: 0.1976 | Recall@20: 0.4945 | NDCG@20: 0.3845 | Hit@20: 0.8458 | MAP: 0.2995 | MRR: 0.4495
2025-11-23 12:36:31,656 | INFO | Saved best model to model\best_model_cgfm_no_inter.pth
2025-11-23 12:38:37,697 | INFO | Epoch 04 | Loss: 0.4875 (Rec: 0.4803, Con: 0.0727) | Val AUC: 0.7959 | Gate Mean: 0.2596 (Std: 0.0041) | Precision@5: 0.2921 | Recall@5: 0.2119 | NDCG@5: 0.3329 | Hit@5: 0.6530 | Precision@10: 0.2536 | Recall@10: 0.3448 | NDCG@10: 0.3582 | Hit@10: 0.7724 | Precision@20: 0.2083 | Recall@20: 0.5267 | NDCG@20: 0.4117 | Hit@20: 0.8695 | MAP: 0.3197 | MRR: 0.4779
2025-11-23 12:38:37,711 | INFO | Saved best model to model\best_model_cgfm_no_inter.pth
2025-11-23 12:40:31,528 | INFO | Epoch 05 | Loss: 0.4529 (Rec: 0.4458, Con: 0.0707) | Val AUC: 0.7904 | Gate Mean: 0.4088 (Std: 0.0023) | Precision@5: 0.2972 | Recall@5: 0.2179 | NDCG@5: 0.3416 | Hit@5: 0.6772 | Precision@10: 0.2593 | Recall@10: 0.3563 | NDCG@10: 0.3694 | Hit@10: 0.7932 | Precision@20: 0.2091 | Recall@20: 0.5329 | NDCG@20: 0.4197 | Hit@20: 0.8794 | MAP: 0.3237 | MRR: 0.4932
2025-11-23 12:42:24,542 | INFO | Epoch 06 | Loss: 0.4185 (Rec: 0.4116, Con: 0.0690) | Val AUC: 0.7843 | Gate Mean: 0.5026 (Std: 0.0046) | Precision@5: 0.3060 | Recall@5: 0.2263 | NDCG@5: 0.3535 | Hit@5: 0.6923 | Precision@10: 0.2646 | Recall@10: 0.3633 | NDCG@10: 0.3793 | Hit@10: 0.8049 | Precision@20: 0.2115 | Recall@20: 0.5357 | NDCG@20: 0.4280 | Hit@20: 0.8899 | MAP: 0.3298 | MRR: 0.5099
2025-11-23 12:44:15,559 | INFO | Epoch 07 | Loss: 0.3858 (Rec: 0.3791, Con: 0.0676) | Val AUC: 0.7769 | Gate Mean: 0.5541 (Std: 0.0072) | Precision@5: 0.3045 | Recall@5: 0.2256 | NDCG@5: 0.3526 | Hit@5: 0.7011 | Precision@10: 0.2617 | Recall@10: 0.3597 | NDCG@10: 0.3765 | Hit@10: 0.8093 | Precision@20: 0.2083 | Recall@20: 0.5299 | NDCG@20: 0.4236 | Hit@20: 0.8906 | MAP: 0.3231 | MRR: 0.5142
2025-11-23 12:46:08,365 | INFO | Epoch 08 | Loss: 0.3226 (Rec: 0.3168, Con: 0.0585) | Val AUC: 0.7735 | Gate Mean: 0.4843 (Std: 0.0070) | Precision@5: 0.3132 | Recall@5: 0.2324 | NDCG@5: 0.3626 | Hit@5: 0.7115 | Precision@10: 0.2672 | Recall@10: 0.3680 | NDCG@10: 0.3852 | Hit@10: 0.8204 | Precision@20: 0.2121 | Recall@20: 0.5381 | NDCG@20: 0.4318 | Hit@20: 0.8965 | MAP: 0.3286 | MRR: 0.5223
2025-11-23 12:48:00,416 | INFO | Epoch 09 | Loss: 0.3001 (Rec: 0.2944, Con: 0.0574) | Val AUC: 0.7681 | Gate Mean: 0.4892 (Std: 0.0049) | Precision@5: 0.3067 | Recall@5: 0.2262 | NDCG@5: 0.3537 | Hit@5: 0.7051 | Precision@10: 0.2630 | Recall@10: 0.3648 | NDCG@10: 0.3782 | Hit@10: 0.8165 | Precision@20: 0.2084 | Recall@20: 0.5312 | NDCG@20: 0.4240 | Hit@20: 0.8960 | MAP: 0.3210 | MRR: 0.5142
2025-11-23 12:49:52,772 | INFO | Epoch 10 | Loss: 0.2831 (Rec: 0.2773, Con: 0.0577) | Val AUC: 0.7628 | Gate Mean: 0.4969 (Std: 0.0060) | Precision@5: 0.3056 | Recall@5: 0.2242 | NDCG@5: 0.3556 | Hit@5: 0.7056 | Precision@10: 0.2626 | Recall@10: 0.3644 | NDCG@10: 0.3801 | Hit@10: 0.8223 | Precision@20: 0.2090 | Recall@20: 0.5345 | NDCG@20: 0.4269 | Hit@20: 0.9010 | MAP: 0.3219 | MRR: 0.5225
2025-11-23 12:51:47,222 | INFO | Epoch 11 | Loss: 0.2465 (Rec: 0.2411, Con: 0.0539) | Val AUC: 0.7619 | Gate Mean: 0.4622 (Std: 0.0057) | Precision@5: 0.3098 | Recall@5: 0.2286 | NDCG@5: 0.3589 | Hit@5: 0.7113 | Precision@10: 0.2643 | Recall@10: 0.3648 | NDCG@10: 0.3819 | Hit@10: 0.8217 | Precision@20: 0.2087 | Recall@20: 0.5293 | NDCG@20: 0.4266 | Hit@20: 0.8962 | MAP: 0.3232 | MRR: 0.5205
2025-11-23 12:53:40,688 | INFO | Epoch 12 | Loss: 0.2373 (Rec: 0.2320, Con: 0.0533) | Val AUC: 0.7595 | Gate Mean: 0.4491 (Std: 0.0051) | Precision@5: 0.3096 | Recall@5: 0.2283 | NDCG@5: 0.3586 | Hit@5: 0.7080 | Precision@10: 0.2630 | Recall@10: 0.3626 | NDCG@10: 0.3801 | Hit@10: 0.8171 | Precision@20: 0.2077 | Recall@20: 0.5274 | NDCG@20: 0.4246 | Hit@20: 0.8979 | MAP: 0.3213 | MRR: 0.5207
2025-11-23 12:55:32,063 | INFO | Epoch 13 | Loss: 0.2297 (Rec: 0.2244, Con: 0.0536) | Val AUC: 0.7571 | Gate Mean: 0.4453 (Std: 0.0052) | Precision@5: 0.3076 | Recall@5: 0.2264 | NDCG@5: 0.3570 | Hit@5: 0.7105 | Precision@10: 0.2649 | Recall@10: 0.3640 | NDCG@10: 0.3812 | Hit@10: 0.8217 | Precision@20: 0.2093 | Recall@20: 0.5309 | NDCG@20: 0.4264 | Hit@20: 0.8982 | MAP: 0.3212 | MRR: 0.5219
2025-11-23 12:57:22,859 | INFO | Epoch 14 | Loss: 0.2105 (Rec: 0.2053, Con: 0.0514) | Val AUC: 0.7560 | Gate Mean: 0.4238 (Std: 0.0052) | Precision@5: 0.3114 | Recall@5: 0.2298 | NDCG@5: 0.3604 | Hit@5: 0.7160 | Precision@10: 0.2644 | Recall@10: 0.3635 | NDCG@10: 0.3818 | Hit@10: 0.8249 | Precision@20: 0.2089 | Recall@20: 0.5288 | NDCG@20: 0.4263 | Hit@20: 0.9007 | MAP: 0.3215 | MRR: 0.5230
2025-11-23 12:59:11,679 | INFO | Epoch 15 | Loss: 0.2067 (Rec: 0.2015, Con: 0.0512) | Val AUC: 0.7555 | Gate Mean: 0.4117 (Std: 0.0056) | Precision@5: 0.3072 | Recall@5: 0.2278 | NDCG@5: 0.3566 | Hit@5: 0.7124 | Precision@10: 0.2629 | Recall@10: 0.3601 | NDCG@10: 0.3787 | Hit@10: 0.8210 | Precision@20: 0.2080 | Recall@20: 0.5266 | NDCG@20: 0.4240 | Hit@20: 0.8989 | MAP: 0.3198 | MRR: 0.5199
2025-11-23 13:01:01,447 | INFO | Epoch 16 | Loss: 0.2031 (Rec: 0.1980, Con: 0.0514) | Val AUC: 0.7530 | Gate Mean: 0.4093 (Std: 0.0059) | Precision@5: 0.3103 | Recall@5: 0.2300 | NDCG@5: 0.3604 | Hit@5: 0.7169 | Precision@10: 0.2637 | Recall@10: 0.3634 | NDCG@10: 0.3818 | Hit@10: 0.8231 | Precision@20: 0.2079 | Recall@20: 0.5271 | NDCG@20: 0.4259 | Hit@20: 0.8960 | MAP: 0.3212 | MRR: 0.5254
2025-11-23 13:02:53,512 | INFO | Epoch 17 | Loss: 0.1933 (Rec: 0.1883, Con: 0.0501) | Val AUC: 0.7540 | Gate Mean: 0.3893 (Std: 0.0068) | Precision@5: 0.3078 | Recall@5: 0.2262 | NDCG@5: 0.3558 | Hit@5: 0.7080 | Precision@10: 0.2629 | Recall@10: 0.3598 | NDCG@10: 0.3781 | Hit@10: 0.8186 | Precision@20: 0.2077 | Recall@20: 0.5248 | NDCG@20: 0.4226 | Hit@20: 0.8988 | MAP: 0.3183 | MRR: 0.5189
2025-11-23 13:04:40,896 | INFO | Epoch 18 | Loss: 0.1915 (Rec: 0.1865, Con: 0.0503) | Val AUC: 0.7532 | Gate Mean: 0.3805 (Std: 0.0067) | Precision@5: 0.3073 | Recall@5: 0.2263 | NDCG@5: 0.3571 | Hit@5: 0.7101 | Precision@10: 0.2626 | Recall@10: 0.3594 | NDCG@10: 0.3791 | Hit@10: 0.8212 | Precision@20: 0.2076 | Recall@20: 0.5246 | NDCG@20: 0.4235 | Hit@20: 0.8969 | MAP: 0.3189 | MRR: 0.5217
2025-11-23 13:06:30,626 | INFO | Epoch 19 | Loss: 0.1898 (Rec: 0.1848, Con: 0.0502) | Val AUC: 0.7531 | Gate Mean: 0.3736 (Std: 0.0069) | Precision@5: 0.3087 | Recall@5: 0.2270 | NDCG@5: 0.3588 | Hit@5: 0.7115 | Precision@10: 0.2638 | Recall@10: 0.3608 | NDCG@10: 0.3803 | Hit@10: 0.8223 | Precision@20: 0.2083 | Recall@20: 0.5288 | NDCG@20: 0.4254 | Hit@20: 0.9007 | MAP: 0.3199 | MRR: 0.5232
2025-11-23 13:08:24,703 | INFO | Epoch 20 | Loss: 0.1849 (Rec: 0.1799, Con: 0.0498) | Val AUC: 0.7527 | Gate Mean: 0.3640 (Std: 0.0071) | Precision@5: 0.3114 | Recall@5: 0.2284 | NDCG@5: 0.3611 | Hit@5: 0.7108 | Precision@10: 0.2640 | Recall@10: 0.3606 | NDCG@10: 0.3812 | Hit@10: 0.8184 | Precision@20: 0.2076 | Recall@20: 0.5254 | NDCG@20: 0.4246 | Hit@20: 0.8974 | MAP: 0.3199 | MRR: 0.5235
2025-11-23 13:10:18,662 | INFO | Epoch 21 | Loss: 0.1840 (Rec: 0.1791, Con: 0.0494) | Val AUC: 0.7524 | Gate Mean: 0.3609 (Std: 0.0070) | Precision@5: 0.3093 | Recall@5: 0.2265 | NDCG@5: 0.3574 | Hit@5: 0.7091 | Precision@10: 0.2628 | Recall@10: 0.3606 | NDCG@10: 0.3790 | Hit@10: 0.8214 | Precision@20: 0.2075 | Recall@20: 0.5265 | NDCG@20: 0.4235 | Hit@20: 0.8986 | MAP: 0.3189 | MRR: 0.5190
2025-11-23 13:12:10,292 | INFO | Epoch 22 | Loss: 0.1833 (Rec: 0.1783, Con: 0.0500) | Val AUC: 0.7521 | Gate Mean: 0.3573 (Std: 0.0073) | Precision@5: 0.3087 | Recall@5: 0.2290 | NDCG@5: 0.3599 | Hit@5: 0.7113 | Precision@10: 0.2629 | Recall@10: 0.3613 | NDCG@10: 0.3809 | Hit@10: 0.8202 | Precision@20: 0.2070 | Recall@20: 0.5237 | NDCG@20: 0.4243 | Hit@20: 0.8982 | MAP: 0.3207 | MRR: 0.5253
2025-11-23 13:14:02,629 | INFO | Epoch 23 | Loss: 0.1807 (Rec: 0.1758, Con: 0.0495) | Val AUC: 0.7521 | Gate Mean: 0.3510 (Std: 0.0073) | Precision@5: 0.3095 | Recall@5: 0.2274 | NDCG@5: 0.3586 | Hit@5: 0.7117 | Precision@10: 0.2626 | Recall@10: 0.3610 | NDCG@10: 0.3794 | Hit@10: 0.8217 | Precision@20: 0.2069 | Recall@20: 0.5244 | NDCG@20: 0.4233 | Hit@20: 0.8974 | MAP: 0.3192 | MRR: 0.5236
2025-11-23 13:15:54,735 | INFO | Epoch 24 | Loss: 0.1803 (Rec: 0.1754, Con: 0.0498) | Val AUC: 0.7523 | Gate Mean: 0.3472 (Std: 0.0074) | Precision@5: 0.3085 | Recall@5: 0.2285 | NDCG@5: 0.3594 | Hit@5: 0.7158 | Precision@10: 0.2633 | Recall@10: 0.3596 | NDCG@10: 0.3806 | Hit@10: 0.8188 | Precision@20: 0.2072 | Recall@20: 0.5250 | NDCG@20: 0.4246 | Hit@20: 0.8991 | MAP: 0.3207 | MRR: 0.5240
2025-11-23 13:17:46,922 | INFO | Epoch 25 | Loss: 0.1799 (Rec: 0.1750, Con: 0.0494) | Val AUC: 0.7520 | Gate Mean: 0.3453 (Std: 0.0074) | Precision@5: 0.3097 | Recall@5: 0.2288 | NDCG@5: 0.3592 | Hit@5: 0.7151 | Precision@10: 0.2629 | Recall@10: 0.3594 | NDCG@10: 0.3793 | Hit@10: 0.8219 | Precision@20: 0.2065 | Recall@20: 0.5213 | NDCG@20: 0.4222 | Hit@20: 0.8975 | MAP: 0.3179 | MRR: 0.5245
2025-11-23 13:19:39,008 | INFO | Epoch 26 | Loss: 0.1786 (Rec: 0.1737, Con: 0.0490) | Val AUC: 0.7520 | Gate Mean: 0.3439 (Std: 0.0074) | Precision@5: 0.3074 | Recall@5: 0.2273 | NDCG@5: 0.3582 | Hit@5: 0.7110 | Precision@10: 0.2629 | Recall@10: 0.3603 | NDCG@10: 0.3799 | Hit@10: 0.8209 | Precision@20: 0.2067 | Recall@20: 0.5235 | NDCG@20: 0.4231 | Hit@20: 0.8981 | MAP: 0.3188 | MRR: 0.5256
2025-11-23 13:21:31,340 | INFO | Epoch 27 | Loss: 0.1784 (Rec: 0.1735, Con: 0.0491) | Val AUC: 0.7520 | Gate Mean: 0.3417 (Std: 0.0075) | Precision@5: 0.3069 | Recall@5: 0.2264 | NDCG@5: 0.3568 | Hit@5: 0.7111 | Precision@10: 0.2625 | Recall@10: 0.3595 | NDCG@10: 0.3790 | Hit@10: 0.8214 | Precision@20: 0.2069 | Recall@20: 0.5245 | NDCG@20: 0.4232 | Hit@20: 0.8986 | MAP: 0.3190 | MRR: 0.5211
2025-11-23 13:23:22,543 | INFO | Epoch 28 | Loss: 0.1782 (Rec: 0.1733, Con: 0.0488) | Val AUC: 0.7520 | Gate Mean: 0.3415 (Std: 0.0074) | Precision@5: 0.3101 | Recall@5: 0.2290 | NDCG@5: 0.3607 | Hit@5: 0.7165 | Precision@10: 0.2635 | Recall@10: 0.3606 | NDCG@10: 0.3808 | Hit@10: 0.8231 | Precision@20: 0.2073 | Recall@20: 0.5251 | NDCG@20: 0.4244 | Hit@20: 0.8977 | MAP: 0.3196 | MRR: 0.5264
2025-11-23 13:25:15,132 | INFO | Epoch 29 | Loss: 0.1776 (Rec: 0.1727, Con: 0.0491) | Val AUC: 0.7519 | Gate Mean: 0.3407 (Std: 0.0075) | Precision@5: 0.3098 | Recall@5: 0.2278 | NDCG@5: 0.3588 | Hit@5: 0.7134 | Precision@10: 0.2630 | Recall@10: 0.3600 | NDCG@10: 0.3793 | Hit@10: 0.8202 | Precision@20: 0.2071 | Recall@20: 0.5244 | NDCG@20: 0.4232 | Hit@20: 0.8986 | MAP: 0.3188 | MRR: 0.5217
2025-11-23 13:27:06,788 | INFO | Epoch 30 | Loss: 0.1775 (Rec: 0.1726, Con: 0.0492) | Val AUC: 0.7518 | Gate Mean: 0.3399 (Std: 0.0075) | Precision@5: 0.3080 | Recall@5: 0.2282 | NDCG@5: 0.3574 | Hit@5: 0.7182 | Precision@10: 0.2627 | Recall@10: 0.3609 | NDCG@10: 0.3790 | Hit@10: 0.8247 | Precision@20: 0.2063 | Recall@20: 0.5238 | NDCG@20: 0.4226 | Hit@20: 0.8993 | MAP: 0.3187 | MRR: 0.5209
