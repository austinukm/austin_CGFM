2025-11-23 13:35:38,205 | INFO | Logging to: logs\mf_model\train_20251123_133538.log
2025-11-23 13:35:38,205 | INFO | Using device: cuda
2025-11-23 13:35:38,205 | INFO | Arguments: {'train_csv': 'data\\train_val_test_dir\\train.csv', 'val_csv': 'data\\train_val_test_dir\\val.csv', 'all_csv': 'data\\train_val_test_dir\\all_ratings.csv', 'text_features': 'feature_output\\movie_text_features_20251103_1457.npz', 'img_features': 'feature_output\\movie_img_features_20251103_1457.npz', 'batch_size': 64, 'epochs': 30, 'lr': 0.001, 'emb_dim': 64, 'topk': [5, 10, 20], 'sample_neg': 100, 'topk_max_users': 0, 'no_scheduler': False, 'log_name': 'mf_model', 'device': None}
2025-11-23 13:36:20,649 | INFO | Epoch 01 | Loss: 0.5877 | Val AUC: 0.7864 | Precision@5: 0.2781 | Recall@5: 0.1996 | NDCG@5: 0.3156 | Hit@5: 0.6094 | Precision@10: 0.2469 | Recall@10: 0.3312 | NDCG@10: 0.3436 | Hit@10: 0.7330 | Precision@20: 0.2074 | Recall@20: 0.5139 | NDCG@20: 0.3994 | Hit@20: 0.8302 | MAP: 0.3165 | MRR: 0.4493
2025-11-23 13:36:20,655 | INFO | Saved best model to model\best_model_mf_model.pth
2025-11-23 13:37:03,904 | INFO | Epoch 02 | Loss: 0.5367 | Val AUC: 0.7963 | Precision@5: 0.3006 | Recall@5: 0.2197 | NDCG@5: 0.3429 | Hit@5: 0.6424 | Precision@10: 0.2605 | Recall@10: 0.3532 | NDCG@10: 0.3686 | Hit@10: 0.7539 | Precision@20: 0.2139 | Recall@20: 0.5292 | NDCG@20: 0.4207 | Hit@20: 0.8425 | MAP: 0.3346 | MRR: 0.4775
2025-11-23 13:37:03,909 | INFO | Saved best model to model\best_model_mf_model.pth
2025-11-23 13:37:45,879 | INFO | Epoch 03 | Loss: 0.5247 | Val AUC: 0.8018 | Precision@5: 0.3113 | Recall@5: 0.2301 | NDCG@5: 0.3576 | Hit@5: 0.6651 | Precision@10: 0.2703 | Recall@10: 0.3685 | NDCG@10: 0.3845 | Hit@10: 0.7731 | Precision@20: 0.2198 | Recall@20: 0.5441 | NDCG@20: 0.4359 | Hit@20: 0.8577 | MAP: 0.3447 | MRR: 0.4962
2025-11-23 13:37:45,883 | INFO | Saved best model to model\best_model_mf_model.pth
2025-11-23 13:38:38,886 | INFO | Epoch 04 | Loss: 0.5136 | Val AUC: 0.8061 | Precision@5: 0.3219 | Recall@5: 0.2379 | NDCG@5: 0.3689 | Hit@5: 0.6819 | Precision@10: 0.2783 | Recall@10: 0.3817 | NDCG@10: 0.3968 | Hit@10: 0.7908 | Precision@20: 0.2239 | Recall@20: 0.5598 | NDCG@20: 0.4481 | Hit@20: 0.8704 | MAP: 0.3532 | MRR: 0.5079
2025-11-23 13:38:38,892 | INFO | Saved best model to model\best_model_mf_model.pth
2025-11-23 13:39:23,897 | INFO | Epoch 05 | Loss: 0.5034 | Val AUC: 0.8081 | Precision@5: 0.3337 | Recall@5: 0.2490 | NDCG@5: 0.3859 | Hit@5: 0.6982 | Precision@10: 0.2846 | Recall@10: 0.3873 | NDCG@10: 0.4097 | Hit@10: 0.7944 | Precision@20: 0.2271 | Recall@20: 0.5643 | NDCG@20: 0.4596 | Hit@20: 0.8742 | MAP: 0.3638 | MRR: 0.5271
2025-11-23 13:39:23,901 | INFO | Saved best model to model\best_model_mf_model.pth
2025-11-23 13:40:04,242 | INFO | Epoch 06 | Loss: 0.4936 | Val AUC: 0.8098 | Precision@5: 0.3371 | Recall@5: 0.2509 | NDCG@5: 0.3897 | Hit@5: 0.7044 | Precision@10: 0.2895 | Recall@10: 0.3969 | NDCG@10: 0.4166 | Hit@10: 0.8069 | Precision@20: 0.2295 | Recall@20: 0.5684 | NDCG@20: 0.4646 | Hit@20: 0.8747 | MAP: 0.3673 | MRR: 0.5333
2025-11-23 13:40:04,246 | INFO | Saved best model to model\best_model_mf_model.pth
2025-11-23 13:40:44,161 | INFO | Epoch 07 | Loss: 0.4842 | Val AUC: 0.8100 | Precision@5: 0.3402 | Recall@5: 0.2559 | NDCG@5: 0.3942 | Hit@5: 0.7134 | Precision@10: 0.2909 | Recall@10: 0.3994 | NDCG@10: 0.4201 | Hit@10: 0.8079 | Precision@20: 0.2295 | Recall@20: 0.5744 | NDCG@20: 0.4685 | Hit@20: 0.8823 | MAP: 0.3699 | MRR: 0.5368
2025-11-23 13:40:44,164 | INFO | Saved best model to model\best_model_mf_model.pth
2025-11-23 13:41:40,762 | INFO | Epoch 08 | Loss: 0.4749 | Val AUC: 0.8101 | Precision@5: 0.3428 | Recall@5: 0.2588 | NDCG@5: 0.3981 | Hit@5: 0.7179 | Precision@10: 0.2935 | Recall@10: 0.4051 | NDCG@10: 0.4245 | Hit@10: 0.8148 | Precision@20: 0.2324 | Recall@20: 0.5786 | NDCG@20: 0.4730 | Hit@20: 0.8832 | MAP: 0.3726 | MRR: 0.5457
2025-11-23 13:41:40,767 | INFO | Saved best model to model\best_model_mf_model.pth
2025-11-23 13:42:31,179 | INFO | Epoch 09 | Loss: 0.4659 | Val AUC: 0.8095 | Precision@5: 0.3474 | Recall@5: 0.2622 | NDCG@5: 0.4031 | Hit@5: 0.7236 | Precision@10: 0.2946 | Recall@10: 0.4052 | NDCG@10: 0.4274 | Hit@10: 0.8131 | Precision@20: 0.2313 | Recall@20: 0.5774 | NDCG@20: 0.4744 | Hit@20: 0.8834 | MAP: 0.3739 | MRR: 0.5518
2025-11-23 13:43:23,504 | INFO | Epoch 10 | Loss: 0.4573 | Val AUC: 0.8086 | Precision@5: 0.3495 | Recall@5: 0.2638 | NDCG@5: 0.4056 | Hit@5: 0.7274 | Precision@10: 0.2978 | Recall@10: 0.4075 | NDCG@10: 0.4306 | Hit@10: 0.8186 | Precision@20: 0.2317 | Recall@20: 0.5761 | NDCG@20: 0.4755 | Hit@20: 0.8866 | MAP: 0.3752 | MRR: 0.5535
2025-11-23 13:44:16,726 | INFO | Epoch 11 | Loss: 0.4372 | Val AUC: 0.8103 | Precision@5: 0.3542 | Recall@5: 0.2664 | NDCG@5: 0.4117 | Hit@5: 0.7331 | Precision@10: 0.3006 | Recall@10: 0.4128 | NDCG@10: 0.4363 | Hit@10: 0.8228 | Precision@20: 0.2339 | Recall@20: 0.5843 | NDCG@20: 0.4819 | Hit@20: 0.8889 | MAP: 0.3800 | MRR: 0.5597
2025-11-23 13:44:16,732 | INFO | Saved best model to model\best_model_mf_model.pth
2025-11-23 13:45:09,818 | INFO | Epoch 12 | Loss: 0.4310 | Val AUC: 0.8097 | Precision@5: 0.3523 | Recall@5: 0.2677 | NDCG@5: 0.4126 | Hit@5: 0.7295 | Precision@10: 0.2985 | Recall@10: 0.4138 | NDCG@10: 0.4374 | Hit@10: 0.8216 | Precision@20: 0.2332 | Recall@20: 0.5846 | NDCG@20: 0.4836 | Hit@20: 0.8924 | MAP: 0.3827 | MRR: 0.5599
2025-11-23 13:46:02,318 | INFO | Epoch 13 | Loss: 0.4259 | Val AUC: 0.8089 | Precision@5: 0.3566 | Recall@5: 0.2705 | NDCG@5: 0.4155 | Hit@5: 0.7375 | Precision@10: 0.3005 | Recall@10: 0.4159 | NDCG@10: 0.4389 | Hit@10: 0.8281 | Precision@20: 0.2338 | Recall@20: 0.5843 | NDCG@20: 0.4841 | Hit@20: 0.8891 | MAP: 0.3823 | MRR: 0.5622
2025-11-23 13:46:55,519 | INFO | Epoch 14 | Loss: 0.4215 | Val AUC: 0.8082 | Precision@5: 0.3551 | Recall@5: 0.2686 | NDCG@5: 0.4137 | Hit@5: 0.7361 | Precision@10: 0.3001 | Recall@10: 0.4135 | NDCG@10: 0.4377 | Hit@10: 0.8261 | Precision@20: 0.2343 | Recall@20: 0.5869 | NDCG@20: 0.4845 | Hit@20: 0.8920 | MAP: 0.3815 | MRR: 0.5627
2025-11-23 13:47:49,437 | INFO | Epoch 15 | Loss: 0.4093 | Val AUC: 0.8081 | Precision@5: 0.3555 | Recall@5: 0.2702 | NDCG@5: 0.4154 | Hit@5: 0.7390 | Precision@10: 0.3002 | Recall@10: 0.4177 | NDCG@10: 0.4398 | Hit@10: 0.8319 | Precision@20: 0.2345 | Recall@20: 0.5888 | NDCG@20: 0.4860 | Hit@20: 0.8924 | MAP: 0.3824 | MRR: 0.5660
2025-11-23 13:48:46,221 | INFO | Epoch 16 | Loss: 0.4068 | Val AUC: 0.8076 | Precision@5: 0.3549 | Recall@5: 0.2668 | NDCG@5: 0.4121 | Hit@5: 0.7362 | Precision@10: 0.3009 | Recall@10: 0.4162 | NDCG@10: 0.4375 | Hit@10: 0.8313 | Precision@20: 0.2342 | Recall@20: 0.5857 | NDCG@20: 0.4831 | Hit@20: 0.8911 | MAP: 0.3798 | MRR: 0.5604
2025-11-23 13:49:39,308 | INFO | Epoch 17 | Loss: 0.4045 | Val AUC: 0.8072 | Precision@5: 0.3542 | Recall@5: 0.2689 | NDCG@5: 0.4134 | Hit@5: 0.7420 | Precision@10: 0.3021 | Recall@10: 0.4187 | NDCG@10: 0.4401 | Hit@10: 0.8313 | Precision@20: 0.2347 | Recall@20: 0.5888 | NDCG@20: 0.4855 | Hit@20: 0.8941 | MAP: 0.3816 | MRR: 0.5635
2025-11-23 13:50:34,700 | INFO | Epoch 18 | Loss: 0.3977 | Val AUC: 0.8070 | Precision@5: 0.3582 | Recall@5: 0.2729 | NDCG@5: 0.4185 | Hit@5: 0.7433 | Precision@10: 0.3013 | Recall@10: 0.4174 | NDCG@10: 0.4411 | Hit@10: 0.8302 | Precision@20: 0.2348 | Recall@20: 0.5882 | NDCG@20: 0.4870 | Hit@20: 0.8903 | MAP: 0.3831 | MRR: 0.5692
2025-11-23 13:51:49,775 | INFO | Epoch 19 | Loss: 0.3966 | Val AUC: 0.8068 | Precision@5: 0.3570 | Recall@5: 0.2702 | NDCG@5: 0.4157 | Hit@5: 0.7406 | Precision@10: 0.3018 | Recall@10: 0.4182 | NDCG@10: 0.4405 | Hit@10: 0.8302 | Precision@20: 0.2344 | Recall@20: 0.5875 | NDCG@20: 0.4856 | Hit@20: 0.8932 | MAP: 0.3821 | MRR: 0.5645
2025-11-23 13:53:14,033 | INFO | Epoch 20 | Loss: 0.3955 | Val AUC: 0.8066 | Precision@5: 0.3588 | Recall@5: 0.2720 | NDCG@5: 0.4188 | Hit@5: 0.7394 | Precision@10: 0.3012 | Recall@10: 0.4156 | NDCG@10: 0.4409 | Hit@10: 0.8276 | Precision@20: 0.2346 | Recall@20: 0.5864 | NDCG@20: 0.4864 | Hit@20: 0.8934 | MAP: 0.3830 | MRR: 0.5681
2025-11-23 13:54:58,495 | INFO | Epoch 21 | Loss: 0.3919 | Val AUC: 0.8065 | Precision@5: 0.3561 | Recall@5: 0.2696 | NDCG@5: 0.4166 | Hit@5: 0.7385 | Precision@10: 0.3029 | Recall@10: 0.4186 | NDCG@10: 0.4422 | Hit@10: 0.8309 | Precision@20: 0.2350 | Recall@20: 0.5875 | NDCG@20: 0.4870 | Hit@20: 0.8917 | MAP: 0.3838 | MRR: 0.5671
2025-11-23 13:57:04,559 | INFO | Epoch 22 | Loss: 0.3914 | Val AUC: 0.8063 | Precision@5: 0.3559 | Recall@5: 0.2705 | NDCG@5: 0.4154 | Hit@5: 0.7395 | Precision@10: 0.3013 | Recall@10: 0.4177 | NDCG@10: 0.4403 | Hit@10: 0.8311 | Precision@20: 0.2346 | Recall@20: 0.5890 | NDCG@20: 0.4862 | Hit@20: 0.8948 | MAP: 0.3825 | MRR: 0.5634
2025-11-23 13:58:55,974 | INFO | Epoch 23 | Loss: 0.3909 | Val AUC: 0.8062 | Precision@5: 0.3573 | Recall@5: 0.2708 | NDCG@5: 0.4171 | Hit@5: 0.7400 | Precision@10: 0.3015 | Recall@10: 0.4182 | NDCG@10: 0.4412 | Hit@10: 0.8318 | Precision@20: 0.2340 | Recall@20: 0.5874 | NDCG@20: 0.4863 | Hit@20: 0.8934 | MAP: 0.3834 | MRR: 0.5669
2025-11-23 14:01:02,814 | INFO | Epoch 24 | Loss: 0.3890 | Val AUC: 0.8062 | Precision@5: 0.3571 | Recall@5: 0.2713 | NDCG@5: 0.4174 | Hit@5: 0.7423 | Precision@10: 0.3018 | Recall@10: 0.4193 | NDCG@10: 0.4419 | Hit@10: 0.8323 | Precision@20: 0.2344 | Recall@20: 0.5871 | NDCG@20: 0.4867 | Hit@20: 0.8936 | MAP: 0.3831 | MRR: 0.5682
2025-11-23 14:02:55,707 | INFO | Epoch 25 | Loss: 0.3888 | Val AUC: 0.8061 | Precision@5: 0.3573 | Recall@5: 0.2713 | NDCG@5: 0.4173 | Hit@5: 0.7442 | Precision@10: 0.3017 | Recall@10: 0.4162 | NDCG@10: 0.4408 | Hit@10: 0.8274 | Precision@20: 0.2348 | Recall@20: 0.5883 | NDCG@20: 0.4867 | Hit@20: 0.8937 | MAP: 0.3831 | MRR: 0.5651
2025-11-23 14:04:48,070 | INFO | Epoch 26 | Loss: 0.3885 | Val AUC: 0.8061 | Precision@5: 0.3589 | Recall@5: 0.2737 | NDCG@5: 0.4190 | Hit@5: 0.7439 | Precision@10: 0.3032 | Recall@10: 0.4199 | NDCG@10: 0.4433 | Hit@10: 0.8294 | Precision@20: 0.2346 | Recall@20: 0.5863 | NDCG@20: 0.4871 | Hit@20: 0.8929 | MAP: 0.3843 | MRR: 0.5679
2025-11-23 14:06:42,673 | INFO | Epoch 27 | Loss: 0.3876 | Val AUC: 0.8060 | Precision@5: 0.3570 | Recall@5: 0.2709 | NDCG@5: 0.4157 | Hit@5: 0.7423 | Precision@10: 0.3021 | Recall@10: 0.4190 | NDCG@10: 0.4405 | Hit@10: 0.8337 | Precision@20: 0.2340 | Recall@20: 0.5873 | NDCG@20: 0.4851 | Hit@20: 0.8930 | MAP: 0.3817 | MRR: 0.5646
2025-11-23 14:08:31,835 | INFO | Epoch 28 | Loss: 0.3875 | Val AUC: 0.8060 | Precision@5: 0.3561 | Recall@5: 0.2708 | NDCG@5: 0.4166 | Hit@5: 0.7375 | Precision@10: 0.3018 | Recall@10: 0.4207 | NDCG@10: 0.4422 | Hit@10: 0.8314 | Precision@20: 0.2351 | Recall@20: 0.5883 | NDCG@20: 0.4874 | Hit@20: 0.8927 | MAP: 0.3836 | MRR: 0.5684
2025-11-23 14:10:20,261 | INFO | Epoch 29 | Loss: 0.3873 | Val AUC: 0.8060 | Precision@5: 0.3585 | Recall@5: 0.2731 | NDCG@5: 0.4188 | Hit@5: 0.7423 | Precision@10: 0.3018 | Recall@10: 0.4176 | NDCG@10: 0.4418 | Hit@10: 0.8337 | Precision@20: 0.2348 | Recall@20: 0.5897 | NDCG@20: 0.4878 | Hit@20: 0.8953 | MAP: 0.3837 | MRR: 0.5679
2025-11-23 14:12:01,044 | INFO | Epoch 30 | Loss: 0.3869 | Val AUC: 0.8060 | Precision@5: 0.3583 | Recall@5: 0.2727 | NDCG@5: 0.4182 | Hit@5: 0.7420 | Precision@10: 0.3025 | Recall@10: 0.4183 | NDCG@10: 0.4418 | Hit@10: 0.8314 | Precision@20: 0.2344 | Recall@20: 0.5885 | NDCG@20: 0.4868 | Hit@20: 0.8932 | MAP: 0.3829 | MRR: 0.5667
