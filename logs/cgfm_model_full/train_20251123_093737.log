2025-11-23 09:37:37,193 | INFO | Logging to: logs\cgfm_model_full\train_20251123_093737.log
2025-11-23 09:37:37,193 | INFO | Using device: cuda
2025-11-23 09:37:37,193 | INFO | Arguments: {'train_csv': 'data\\train_val_test_dir\\train.csv', 'val_csv': 'data\\train_val_test_dir\\val.csv', 'all_csv': 'data\\train_val_test_dir\\all_ratings.csv', 'text_features': 'feature_output\\movie_text_features_20251103_1457.npz', 'img_features': 'feature_output\\movie_img_features_20251103_1457.npz', 'batch_size': 64, 'epochs': 30, 'lr': 0.0005, 'user_emb_dim': 64, 'proj_hidden_dim': 512, 'proj_dim': 512, 'vector_gate': False, 'lambda_contrast': 0.1, 'topk': [5, 10, 20], 'sample_neg': 100, 'topk_max_users': 0, 'no_scheduler': False, 'log_name': 'cgfm_model_full', 'device': None, 'no_gate': False, 'no_sim': False, 'no_interaction': False}
2025-11-23 09:39:25,231 | INFO | Epoch 01 | Loss: 1.6626 (Rec: 1.2620, Con: 4.0063) | Val AUC: 0.7260 | Gate Mean: 0.5383 (Std: 0.0029) | Precision@5: 0.2227 | Recall@5: 0.1530 | NDCG@5: 0.2505 | Hit@5: 0.5391 | Precision@10: 0.1902 | Recall@10: 0.2491 | NDCG@10: 0.2647 | Hit@10: 0.6523 | Precision@20: 0.1559 | Recall@20: 0.3855 | NDCG@20: 0.3020 | Hit@20: 0.7698 | MAP: 0.2386 | MRR: 0.3852
2025-11-23 09:39:25,246 | INFO | Saved best model to model\best_model_cgfm_model_full.pth
2025-11-23 09:41:14,448 | INFO | Epoch 02 | Loss: 0.6365 (Rec: 0.5679, Con: 0.6861) | Val AUC: 0.7835 | Gate Mean: 0.0144 (Std: 0.0047) | Precision@5: 0.2516 | Recall@5: 0.1785 | NDCG@5: 0.2846 | Hit@5: 0.5850 | Precision@10: 0.2226 | Recall@10: 0.2987 | NDCG@10: 0.3086 | Hit@10: 0.7143 | Precision@20: 0.1867 | Recall@20: 0.4691 | NDCG@20: 0.3592 | Hit@20: 0.8269 | MAP: 0.2794 | MRR: 0.4229
2025-11-23 09:41:14,464 | INFO | Saved best model to model\best_model_cgfm_model_full.pth
2025-11-23 09:43:08,965 | INFO | Epoch 03 | Loss: 0.5252 (Rec: 0.5165, Con: 0.0875) | Val AUC: 0.7927 | Gate Mean: 0.0408 (Std: 0.0205) | Precision@5: 0.2659 | Recall@5: 0.1892 | NDCG@5: 0.3014 | Hit@5: 0.6082 | Precision@10: 0.2365 | Recall@10: 0.3191 | NDCG@10: 0.3290 | Hit@10: 0.7420 | Precision@20: 0.1966 | Recall@20: 0.4942 | NDCG@20: 0.3812 | Hit@20: 0.8427 | MAP: 0.2966 | MRR: 0.4401
2025-11-23 09:43:08,980 | INFO | Saved best model to model\best_model_cgfm_model_full.pth
2025-11-23 09:45:00,666 | INFO | Epoch 04 | Loss: 0.4885 (Rec: 0.4809, Con: 0.0763) | Val AUC: 0.7954 | Gate Mean: 0.0429 (Std: 0.0139) | Precision@5: 0.2797 | Recall@5: 0.2025 | NDCG@5: 0.3192 | Hit@5: 0.6416 | Precision@10: 0.2465 | Recall@10: 0.3342 | NDCG@10: 0.3465 | Hit@10: 0.7660 | Precision@20: 0.2030 | Recall@20: 0.5137 | NDCG@20: 0.3994 | Hit@20: 0.8650 | MAP: 0.3087 | MRR: 0.4654
2025-11-23 09:45:00,681 | INFO | Saved best model to model\best_model_cgfm_model_full.pth
2025-11-23 09:46:52,615 | INFO | Epoch 05 | Loss: 0.4534 (Rec: 0.4462, Con: 0.0716) | Val AUC: 0.7929 | Gate Mean: 0.0652 (Std: 0.0232) | Precision@5: 0.2922 | Recall@5: 0.2148 | NDCG@5: 0.3360 | Hit@5: 0.6694 | Precision@10: 0.2559 | Recall@10: 0.3500 | NDCG@10: 0.3629 | Hit@10: 0.7838 | Precision@20: 0.2075 | Recall@20: 0.5252 | NDCG@20: 0.4133 | Hit@20: 0.8733 | MAP: 0.3189 | MRR: 0.4872
2025-11-23 09:48:47,135 | INFO | Epoch 06 | Loss: 0.4185 (Rec: 0.4116, Con: 0.0683) | Val AUC: 0.7863 | Gate Mean: 0.0845 (Std: 0.0255) | Precision@5: 0.3022 | Recall@5: 0.2211 | NDCG@5: 0.3464 | Hit@5: 0.6847 | Precision@10: 0.2593 | Recall@10: 0.3558 | NDCG@10: 0.3699 | Hit@10: 0.7940 | Precision@20: 0.2102 | Recall@20: 0.5322 | NDCG@20: 0.4206 | Hit@20: 0.8839 | MAP: 0.3226 | MRR: 0.4971
2025-11-23 09:50:40,048 | INFO | Epoch 07 | Loss: 0.3859 (Rec: 0.3792, Con: 0.0671) | Val AUC: 0.7769 | Gate Mean: 0.1177 (Std: 0.0344) | Precision@5: 0.3058 | Recall@5: 0.2250 | NDCG@5: 0.3542 | Hit@5: 0.7034 | Precision@10: 0.2634 | Recall@10: 0.3610 | NDCG@10: 0.3784 | Hit@10: 0.8112 | Precision@20: 0.2107 | Recall@20: 0.5360 | NDCG@20: 0.4275 | Hit@20: 0.8934 | MAP: 0.3258 | MRR: 0.5149
2025-11-23 09:52:32,795 | INFO | Epoch 08 | Loss: 0.3228 (Rec: 0.3169, Con: 0.0591) | Val AUC: 0.7739 | Gate Mean: 0.0787 (Std: 0.0310) | Precision@5: 0.3077 | Recall@5: 0.2261 | NDCG@5: 0.3568 | Hit@5: 0.7023 | Precision@10: 0.2621 | Recall@10: 0.3616 | NDCG@10: 0.3793 | Hit@10: 0.8117 | Precision@20: 0.2102 | Recall@20: 0.5351 | NDCG@20: 0.4279 | Hit@20: 0.8932 | MAP: 0.3252 | MRR: 0.5190
2025-11-23 09:54:24,801 | INFO | Epoch 09 | Loss: 0.3003 (Rec: 0.2944, Con: 0.0591) | Val AUC: 0.7691 | Gate Mean: 0.0603 (Std: 0.0198) | Precision@5: 0.3067 | Recall@5: 0.2265 | NDCG@5: 0.3568 | Hit@5: 0.7021 | Precision@10: 0.2616 | Recall@10: 0.3599 | NDCG@10: 0.3789 | Hit@10: 0.8141 | Precision@20: 0.2085 | Recall@20: 0.5279 | NDCG@20: 0.4252 | Hit@20: 0.8932 | MAP: 0.3236 | MRR: 0.5198
2025-11-23 09:56:17,141 | INFO | Epoch 10 | Loss: 0.2832 (Rec: 0.2773, Con: 0.0594) | Val AUC: 0.7640 | Gate Mean: 0.0819 (Std: 0.0293) | Precision@5: 0.3084 | Recall@5: 0.2247 | NDCG@5: 0.3563 | Hit@5: 0.7006 | Precision@10: 0.2619 | Recall@10: 0.3583 | NDCG@10: 0.3774 | Hit@10: 0.8136 | Precision@20: 0.2093 | Recall@20: 0.5300 | NDCG@20: 0.4248 | Hit@20: 0.8944 | MAP: 0.3209 | MRR: 0.5179
####### 2025-11-23 09:58:10,825 | INFO | Epoch 11 | Loss: 0.2464 (Rec: 0.2408, Con: 0.0561) | Val AUC: 0.7624 | Gate Mean: 0.0914 (Std: 0.0428) | Precision@5: 0.3101 | Recall@5: 0.2264 | NDCG@5: 0.3620 | Hit@5: 0.7089 | Precision@10: 0.2634 | Recall@10: 0.3599 | NDCG@10: 0.3828 | Hit@10: 0.8172 | Precision@20: 0.2093 | Recall@20: 0.5300 | NDCG@20: 0.4291 | Hit@20: 0.8977 | MAP: 0.3258 | MRR: 0.5297
2025-11-23 10:00:03,555 | INFO | Epoch 12 | Loss: 0.2371 (Rec: 0.2315, Con: 0.0566) | Val AUC: 0.7597 | Gate Mean: 0.0875 (Std: 0.0460) | Precision@5: 0.3034 | Recall@5: 0.2214 | NDCG@5: 0.3522 | Hit@5: 0.7006 | Precision@10: 0.2598 | Recall@10: 0.3565 | NDCG@10: 0.3751 | Hit@10: 0.8138 | Precision@20: 0.2060 | Recall@20: 0.5200 | NDCG@20: 0.4199 | Hit@20: 0.8915 | MAP: 0.3180 | MRR: 0.5195
2025-11-23 10:01:56,102 | INFO | Epoch 13 | Loss: 0.2294 (Rec: 0.2237, Con: 0.0569) | Val AUC: 0.7576 | Gate Mean: 0.1047 (Std: 0.0510) | Precision@5: 0.3021 | Recall@5: 0.2195 | NDCG@5: 0.3521 | Hit@5: 0.6994 | Precision@10: 0.2584 | Recall@10: 0.3530 | NDCG@10: 0.3740 | Hit@10: 0.8089 | Precision@20: 0.2046 | Recall@20: 0.5157 | NDCG@20: 0.4176 | Hit@20: 0.8932 | MAP: 0.3165 | MRR: 0.5200
2025-11-23 10:03:48,800 | INFO | Epoch 14 | Loss: 0.2094 (Rec: 0.2039, Con: 0.0553) | Val AUC: 0.7570 | Gate Mean: 0.1536 (Std: 0.0612) | Precision@5: 0.2999 | Recall@5: 0.2171 | NDCG@5: 0.3483 | Hit@5: 0.6990 | Precision@10: 0.2555 | Recall@10: 0.3480 | NDCG@10: 0.3690 | Hit@10: 0.8082 | Precision@20: 0.2040 | Recall@20: 0.5167 | NDCG@20: 0.4150 | Hit@20: 0.8930 | MAP: 0.3136 | MRR: 0.5154
2025-11-23 10:05:42,738 | INFO | Epoch 15 | Loss: 0.2052 (Rec: 0.1997, Con: 0.0554) | Val AUC: 0.7565 | Gate Mean: 0.1427 (Std: 0.0584) | Precision@5: 0.2942 | Recall@5: 0.2134 | NDCG@5: 0.3414 | Hit@5: 0.6956 | Precision@10: 0.2537 | Recall@10: 0.3471 | NDCG@10: 0.3649 | Hit@10: 0.8051 | Precision@20: 0.2024 | Recall@20: 0.5117 | NDCG@20: 0.4101 | Hit@20: 0.8903 | MAP: 0.3096 | MRR: 0.5076
2025-11-23 10:07:35,501 | INFO | Epoch 16 | Loss: 0.2015 (Rec: 0.1959, Con: 0.0559) | Val AUC: 0.7551 | Gate Mean: 0.1500 (Std: 0.0624) | Precision@5: 0.2936 | Recall@5: 0.2120 | NDCG@5: 0.3414 | Hit@5: 0.6914 | Precision@10: 0.2517 | Recall@10: 0.3407 | NDCG@10: 0.3620 | Hit@10: 0.8051 | Precision@20: 0.1990 | Recall@20: 0.5030 | NDCG@20: 0.4048 | Hit@20: 0.8873 | MAP: 0.3060 | MRR: 0.5096
2025-11-23 10:09:29,061 | INFO | Epoch 17 | Loss: 0.1908 (Rec: 0.1853, Con: 0.0557) | Val AUC: 0.7547 | Gate Mean: 0.1903 (Std: 0.0713) | Precision@5: 0.2894 | Recall@5: 0.2099 | NDCG@5: 0.3363 | Hit@5: 0.6878 | Precision@10: 0.2474 | Recall@10: 0.3365 | NDCG@10: 0.3563 | Hit@10: 0.7984 | Precision@20: 0.1979 | Recall@20: 0.5018 | NDCG@20: 0.4013 | Hit@20: 0.8872 | MAP: 0.3037 | MRR: 0.5024
2025-11-23 10:11:21,922 | INFO | Epoch 18 | Loss: 0.1888 (Rec: 0.1833, Con: 0.0557) | Val AUC: 0.7537 | Gate Mean: 0.1888 (Std: 0.0721) | Precision@5: 0.2864 | Recall@5: 0.2086 | NDCG@5: 0.3328 | Hit@5: 0.6822 | Precision@10: 0.2460 | Recall@10: 0.3325 | NDCG@10: 0.3533 | Hit@10: 0.7966 | Precision@20: 0.1970 | Recall@20: 0.4987 | NDCG@20: 0.3987 | Hit@20: 0.8839 | MAP: 0.3017 | MRR: 0.4993
2025-11-23 10:13:14,962 | INFO | Epoch 19 | Loss: 0.1871 (Rec: 0.1814, Con: 0.0563) | Val AUC: 0.7530 | Gate Mean: 0.1703 (Std: 0.0706) | Precision@5: 0.2829 | Recall@5: 0.2056 | NDCG@5: 0.3287 | Hit@5: 0.6776 | Precision@10: 0.2414 | Recall@10: 0.3301 | NDCG@10: 0.3483 | Hit@10: 0.7915 | Precision@20: 0.1941 | Recall@20: 0.4923 | NDCG@20: 0.3931 | Hit@20: 0.8832 | MAP: 0.2984 | MRR: 0.4940
2025-11-23 10:15:10,076 | INFO | Epoch 20 | Loss: 0.1814 (Rec: 0.1759, Con: 0.0555) | Val AUC: 0.7532 | Gate Mean: 0.2219 (Std: 0.0781) | Precision@5: 0.2756 | Recall@5: 0.1980 | NDCG@5: 0.3204 | Hit@5: 0.6648 | Precision@10: 0.2357 | Recall@10: 0.3210 | NDCG@10: 0.3402 | Hit@10: 0.7866 | Precision@20: 0.1915 | Recall@20: 0.4886 | NDCG@20: 0.3874 | Hit@20: 0.8804 | MAP: 0.2938 | MRR: 0.4877
2025-11-23 10:17:03,440 | INFO | Epoch 21 | Loss: 0.1805 (Rec: 0.1749, Con: 0.0556) | Val AUC: 0.7523 | Gate Mean: 0.2225 (Std: 0.0786) | Precision@5: 0.2740 | Recall@5: 0.1980 | NDCG@5: 0.3183 | Hit@5: 0.6629 | Precision@10: 0.2336 | Recall@10: 0.3191 | NDCG@10: 0.3373 | Hit@10: 0.7866 | Precision@20: 0.1898 | Recall@20: 0.4845 | NDCG@20: 0.3836 | Hit@20: 0.8813 | MAP: 0.2908 | MRR: 0.4841
2025-11-23 10:18:56,419 | INFO | Epoch 22 | Loss: 0.1796 (Rec: 0.1740, Con: 0.0560) | Val AUC: 0.7525 | Gate Mean: 0.2311 (Std: 0.0799) | Precision@5: 0.2713 | Recall@5: 0.1980 | NDCG@5: 0.3152 | Hit@5: 0.6687 | Precision@10: 0.2338 | Recall@10: 0.3185 | NDCG@10: 0.3361 | Hit@10: 0.7823 | Precision@20: 0.1895 | Recall@20: 0.4831 | NDCG@20: 0.3823 | Hit@20: 0.8790 | MAP: 0.2905 | MRR: 0.4800
2025-11-23 10:20:49,175 | INFO | Epoch 23 | Loss: 0.1768 (Rec: 0.1712, Con: 0.0558) | Val AUC: 0.7524 | Gate Mean: 0.2386 (Std: 0.0819) | Precision@5: 0.2685 | Recall@5: 0.1937 | NDCG@5: 0.3115 | Hit@5: 0.6620 | Precision@10: 0.2317 | Recall@10: 0.3164 | NDCG@10: 0.3325 | Hit@10: 0.7844 | Precision@20: 0.1877 | Recall@20: 0.4785 | NDCG@20: 0.3777 | Hit@20: 0.8775 | MAP: 0.2867 | MRR: 0.4773
2025-11-23 10:22:42,506 | INFO | Epoch 24 | Loss: 0.1763 (Rec: 0.1707, Con: 0.0553) | Val AUC: 0.7522 | Gate Mean: 0.2371 (Std: 0.0821) | Precision@5: 0.2704 | Recall@5: 0.1956 | NDCG@5: 0.3137 | Hit@5: 0.6613 | Precision@10: 0.2299 | Recall@10: 0.3139 | NDCG@10: 0.3316 | Hit@10: 0.7783 | Precision@20: 0.1883 | Recall@20: 0.4796 | NDCG@20: 0.3788 | Hit@20: 0.8768 | MAP: 0.2877 | MRR: 0.4775
2025-11-23 10:24:35,395 | INFO | Epoch 25 | Loss: 0.1760 (Rec: 0.1703, Con: 0.0563) | Val AUC: 0.7521 | Gate Mean: 0.2437 (Std: 0.0830) | Precision@5: 0.2668 | Recall@5: 0.1925 | NDCG@5: 0.3105 | Hit@5: 0.6563 | Precision@10: 0.2291 | Recall@10: 0.3121 | NDCG@10: 0.3302 | Hit@10: 0.7793 | Precision@20: 0.1868 | Recall@20: 0.4781 | NDCG@20: 0.3770 | Hit@20: 0.8756 | MAP: 0.2862 | MRR: 0.4792
2025-11-23 10:26:27,955 | INFO | Epoch 26 | Loss: 0.1744 (Rec: 0.1688, Con: 0.0560) | Val AUC: 0.7519 | Gate Mean: 0.2489 (Std: 0.0839) | Precision@5: 0.2634 | Recall@5: 0.1911 | NDCG@5: 0.3077 | Hit@5: 0.6547 | Precision@10: 0.2281 | Recall@10: 0.3130 | NDCG@10: 0.3294 | Hit@10: 0.7785 | Precision@20: 0.1866 | Recall@20: 0.4748 | NDCG@20: 0.3759 | Hit@20: 0.8745 | MAP: 0.2859 | MRR: 0.4762
2025-11-23 10:28:20,503 | INFO | Epoch 27 | Loss: 0.1742 (Rec: 0.1686, Con: 0.0562) | Val AUC: 0.7519 | Gate Mean: 0.2499 (Std: 0.0841) | Precision@5: 0.2644 | Recall@5: 0.1927 | NDCG@5: 0.3067 | Hit@5: 0.6571 | Precision@10: 0.2277 | Recall@10: 0.3113 | NDCG@10: 0.3270 | Hit@10: 0.7774 | Precision@20: 0.1862 | Recall@20: 0.4753 | NDCG@20: 0.3738 | Hit@20: 0.8783 | MAP: 0.2838 | MRR: 0.4716
2025-11-23 10:30:10,783 | INFO | Epoch 28 | Loss: 0.1740 (Rec: 0.1684, Con: 0.0559) | Val AUC: 0.7519 | Gate Mean: 0.2550 (Std: 0.0848) | Precision@5: 0.2640 | Recall@5: 0.1925 | NDCG@5: 0.3066 | Hit@5: 0.6589 | Precision@10: 0.2268 | Recall@10: 0.3116 | NDCG@10: 0.3270 | Hit@10: 0.7778 | Precision@20: 0.1853 | Recall@20: 0.4742 | NDCG@20: 0.3735 | Hit@20: 0.8754 | MAP: 0.2842 | MRR: 0.4721
2025-11-23 10:31:56,349 | INFO | Epoch 29 | Loss: 0.1733 (Rec: 0.1677, Con: 0.0564) | Val AUC: 0.7517 | Gate Mean: 0.2566 (Std: 0.0851) | Precision@5: 0.2638 | Recall@5: 0.1923 | NDCG@5: 0.3044 | Hit@5: 0.6570 | Precision@10: 0.2264 | Recall@10: 0.3101 | NDCG@10: 0.3247 | Hit@10: 0.7752 | Precision@20: 0.1852 | Recall@20: 0.4724 | NDCG@20: 0.3709 | Hit@20: 0.8745 | MAP: 0.2818 | MRR: 0.4671
2025-11-23 10:33:42,967 | INFO | Epoch 30 | Loss: 0.1731 (Rec: 0.1676, Con: 0.0558) | Val AUC: 0.7516 | Gate Mean: 0.2594 (Std: 0.0855) | Precision@5: 0.2645 | Recall@5: 0.1917 | NDCG@5: 0.3071 | Hit@5: 0.6556 | Precision@10: 0.2279 | Recall@10: 0.3115 | NDCG@10: 0.3277 | Hit@10: 0.7811 | Precision@20: 0.1864 | Recall@20: 0.4765 | NDCG@20: 0.3747 | Hit@20: 0.8750 | MAP: 0.2848 | MRR: 0.4726
