2025-11-23 10:33:50,488 | INFO | Logging to: logs\cgfm_no_gate\train_20251123_103350.log
2025-11-23 10:33:50,488 | INFO | Using device: cuda
2025-11-23 10:33:50,488 | INFO | Arguments: {'train_csv': 'data\\train_val_test_dir\\train.csv', 'val_csv': 'data\\train_val_test_dir\\val.csv', 'all_csv': 'data\\train_val_test_dir\\all_ratings.csv', 'text_features': 'feature_output\\movie_text_features_20251103_1457.npz', 'img_features': 'feature_output\\movie_img_features_20251103_1457.npz', 'batch_size': 64, 'epochs': 30, 'lr': 0.0005, 'user_emb_dim': 64, 'proj_hidden_dim': 512, 'proj_dim': 512, 'vector_gate': False, 'lambda_contrast': 0.1, 'topk': [5, 10, 20], 'sample_neg': 100, 'topk_max_users': 0, 'no_scheduler': False, 'log_name': 'cgfm_no_gate', 'device': None, 'no_gate': True, 'no_sim': False, 'no_interaction': False}
2025-11-23 10:35:27,811 | INFO | Epoch 01 | Loss: 1.4123 (Rec: 1.3644, Con: 0.4784) | Val AUC: 0.7367 | Gate: N/A | Precision@5: 0.2620 | Recall@5: 0.1860 | NDCG@5: 0.3030 | Hit@5: 0.6054 | Precision@10: 0.2280 | Recall@10: 0.3051 | NDCG@10: 0.3236 | Hit@10: 0.7219 | Precision@20: 0.1849 | Recall@20: 0.4645 | NDCG@20: 0.3675 | Hit@20: 0.8249 | MAP: 0.2824 | MRR: 0.4530
2025-11-23 10:35:27,828 | INFO | Saved best model to model\best_model_cgfm_no_gate.pth
2025-11-23 10:37:02,587 | INFO | Epoch 02 | Loss: 0.5639 (Rec: 0.5570, Con: 0.0691) | Val AUC: 0.7865 | Gate: N/A | Precision@5: 0.2391 | Recall@5: 0.1682 | NDCG@5: 0.2701 | Hit@5: 0.5647 | Precision@10: 0.2156 | Recall@10: 0.2856 | NDCG@10: 0.2960 | Hit@10: 0.6899 | Precision@20: 0.1836 | Recall@20: 0.4585 | NDCG@20: 0.3483 | Hit@20: 0.8101 | MAP: 0.2725 | MRR: 0.4068
2025-11-23 10:37:02,602 | INFO | Saved best model to model\best_model_cgfm_no_gate.pth
2025-11-23 10:38:38,283 | INFO | Epoch 03 | Loss: 0.5166 (Rec: 0.5105, Con: 0.0604) | Val AUC: 0.7947 | Gate: N/A | Precision@5: 0.2701 | Recall@5: 0.1949 | NDCG@5: 0.3066 | Hit@5: 0.6194 | Precision@10: 0.2408 | Recall@10: 0.3264 | NDCG@10: 0.3355 | Hit@10: 0.7492 | Precision@20: 0.2022 | Recall@20: 0.5109 | NDCG@20: 0.3916 | Hit@20: 0.8551 | MAP: 0.3026 | MRR: 0.4497
2025-11-23 10:38:38,298 | INFO | Saved best model to model\best_model_cgfm_no_gate.pth
2025-11-23 10:40:31,191 | INFO | Epoch 04 | Loss: 0.4792 (Rec: 0.4732, Con: 0.0592) | Val AUC: 0.7945 | Gate: N/A | Precision@5: 0.2919 | Recall@5: 0.2127 | NDCG@5: 0.3355 | Hit@5: 0.6570 | Precision@10: 0.2570 | Recall@10: 0.3509 | NDCG@10: 0.3632 | Hit@10: 0.7835 | Precision@20: 0.2103 | Recall@20: 0.5318 | NDCG@20: 0.4162 | Hit@20: 0.8690 | MAP: 0.3204 | MRR: 0.4864
2025-11-23 10:42:23,171 | INFO | Epoch 05 | Loss: 0.4408 (Rec: 0.4350, Con: 0.0588) | Val AUC: 0.7882 | Gate: N/A | Precision@5: 0.2946 | Recall@5: 0.2145 | NDCG@5: 0.3388 | Hit@5: 0.6691 | Precision@10: 0.2586 | Recall@10: 0.3554 | NDCG@10: 0.3672 | Hit@10: 0.7906 | Precision@20: 0.2112 | Recall@20: 0.5391 | NDCG@20: 0.4206 | Hit@20: 0.8839 | MAP: 0.3213 | MRR: 0.4925
###2025-11-23 10:44:15,801 | INFO | Epoch 06 | Loss: 0.4039 (Rec: 0.3981, Con: 0.0578) | Val AUC: 0.7796 | Gate: N/A | Precision@5: 0.3051 | Recall@5: 0.2241 | NDCG@5: 0.3533 | Hit@5: 0.6900 | Precision@10: 0.2629 | Recall@10: 0.3640 | NDCG@10: 0.3785 | Hit@10: 0.8062 | Precision@20: 0.2119 | Recall@20: 0.5402 | NDCG@20: 0.4284 | Hit@20: 0.8880 | MAP: 0.3267 | MRR: 0.5124
###2025-11-23 10:46:09,125 | INFO | Epoch 07 | Loss: 0.3389 (Rec: 0.3336, Con: 0.0530) | Val AUC: 0.7756 | Gate: N/A | Precision@5: 0.3058 | Recall@5: 0.2293 | NDCG@5: 0.3558 | Hit@5: 0.7009 | Precision@10: 0.2622 | Recall@10: 0.3659 | NDCG@10: 0.3802 | Hit@10: 0.8145 | Precision@20: 0.2116 | Recall@20: 0.5405 | NDCG@20: 0.4303 | Hit@20: 0.8943 | MAP: 0.3278 | MRR: 0.5141
2025-11-23 10:48:02,680 | INFO | Epoch 08 | Loss: 0.3142 (Rec: 0.3089, Con: 0.0531) | Val AUC: 0.7700 | Gate: N/A | Precision@5: 0.3076 | Recall@5: 0.2291 | NDCG@5: 0.3582 | Hit@5: 0.7025 | Precision@10: 0.2644 | Recall@10: 0.3661 | NDCG@10: 0.3824 | Hit@10: 0.8172 | Precision@20: 0.2113 | Recall@20: 0.5385 | NDCG@20: 0.4306 | Hit@20: 0.8951 | MAP: 0.3269 | MRR: 0.5201
2025-11-23 10:49:55,672 | INFO | Epoch 09 | Loss: 0.2950 (Rec: 0.2898, Con: 0.0527) | Val AUC: 0.7632 | Gate: N/A | Precision@5: 0.3066 | Recall@5: 0.2270 | NDCG@5: 0.3579 | Hit@5: 0.7065 | Precision@10: 0.2631 | Recall@10: 0.3649 | NDCG@10: 0.3819 | Hit@10: 0.8183 | Precision@20: 0.2105 | Recall@20: 0.5376 | NDCG@20: 0.4298 | Hit@20: 0.8989 | MAP: 0.3242 | MRR: 0.5250
2025-11-23 10:51:48,932 | INFO | Epoch 10 | Loss: 0.2574 (Rec: 0.2523, Con: 0.0506) | Val AUC: 0.7613 | Gate: N/A | Precision@5: 0.3105 | Recall@5: 0.2307 | NDCG@5: 0.3601 | Hit@5: 0.7144 | Precision@10: 0.2648 | Recall@10: 0.3657 | NDCG@10: 0.3824 | Hit@10: 0.8233 | Precision@20: 0.2117 | Recall@20: 0.5395 | NDCG@20: 0.4306 | Hit@20: 0.9013 | MAP: 0.3245 | MRR: 0.5236
2025-11-23 10:53:41,740 | INFO | Epoch 11 | Loss: 0.2474 (Rec: 0.2424, Con: 0.0501) | Val AUC: 0.7596 | Gate: N/A | Precision@5: 0.3084 | Recall@5: 0.2288 | NDCG@5: 0.3596 | Hit@5: 0.7144 | Precision@10: 0.2641 | Recall@10: 0.3661 | NDCG@10: 0.3829 | Hit@10: 0.8224 | Precision@20: 0.2109 | Recall@20: 0.5373 | NDCG@20: 0.4303 | Hit@20: 0.8998 | MAP: 0.3241 | MRR: 0.5254
2025-11-23 10:55:34,720 | INFO | Epoch 12 | Loss: 0.2389 (Rec: 0.2339, Con: 0.0504) | Val AUC: 0.7577 | Gate: N/A | Precision@5: 0.3092 | Recall@5: 0.2294 | NDCG@5: 0.3597 | Hit@5: 0.7148 | Precision@10: 0.2640 | Recall@10: 0.3645 | NDCG@10: 0.3824 | Hit@10: 0.8235 | Precision@20: 0.2094 | Recall@20: 0.5333 | NDCG@20: 0.4281 | Hit@20: 0.8986 | MAP: 0.3220 | MRR: 0.5248
2025-11-23 10:57:26,362 | INFO | Epoch 13 | Loss: 0.2190 (Rec: 0.2140, Con: 0.0493) | Val AUC: 0.7570 | Gate: N/A | Precision@5: 0.3073 | Recall@5: 0.2270 | NDCG@5: 0.3576 | Hit@5: 0.7094 | Precision@10: 0.2616 | Recall@10: 0.3607 | NDCG@10: 0.3794 | Hit@10: 0.8174 | Precision@20: 0.2080 | Recall@20: 0.5310 | NDCG@20: 0.4258 | Hit@20: 0.8982 | MAP: 0.3212 | MRR: 0.5210
2025-11-23 10:59:18,817 | INFO | Epoch 14 | Loss: 0.2146 (Rec: 0.2097, Con: 0.0486) | Val AUC: 0.7566 | Gate: N/A | Precision@5: 0.3087 | Recall@5: 0.2306 | NDCG@5: 0.3601 | Hit@5: 0.7195 | Precision@10: 0.2614 | Recall@10: 0.3624 | NDCG@10: 0.3804 | Hit@10: 0.8202 | Precision@20: 0.2076 | Recall@20: 0.5286 | NDCG@20: 0.4258 | Hit@20: 0.8953 | MAP: 0.3214 | MRR: 0.5247
2025-11-23 11:01:11,271 | INFO | Epoch 15 | Loss: 0.2107 (Rec: 0.2058, Con: 0.0491) | Val AUC: 0.7553 | Gate: N/A | Precision@5: 0.3069 | Recall@5: 0.2264 | NDCG@5: 0.3580 | Hit@5: 0.7122 | Precision@10: 0.2596 | Recall@10: 0.3599 | NDCG@10: 0.3787 | Hit@10: 0.8183 | Precision@20: 0.2069 | Recall@20: 0.5279 | NDCG@20: 0.4248 | Hit@20: 0.8963 | MAP: 0.3204 | MRR: 0.5252
2025-11-23 11:03:04,102 | INFO | Epoch 16 | Loss: 0.2004 (Rec: 0.1955, Con: 0.0489) | Val AUC: 0.7555 | Gate: N/A | Precision@5: 0.3059 | Recall@5: 0.2249 | NDCG@5: 0.3577 | Hit@5: 0.7053 | Precision@10: 0.2608 | Recall@10: 0.3616 | NDCG@10: 0.3801 | Hit@10: 0.8207 | Precision@20: 0.2071 | Recall@20: 0.5285 | NDCG@20: 0.4254 | Hit@20: 0.8996 | MAP: 0.3214 | MRR: 0.5253
2025-11-23 11:04:56,834 | INFO | Epoch 17 | Loss: 0.1983 (Rec: 0.1935, Con: 0.0486) | Val AUC: 0.7549 | Gate: N/A | Precision@5: 0.3079 | Recall@5: 0.2301 | NDCG@5: 0.3589 | Hit@5: 0.7167 | Precision@10: 0.2617 | Recall@10: 0.3632 | NDCG@10: 0.3805 | Hit@10: 0.8240 | Precision@20: 0.2067 | Recall@20: 0.5273 | NDCG@20: 0.4248 | Hit@20: 0.8979 | MAP: 0.3208 | MRR: 0.5237
2025-11-23 11:06:50,224 | INFO | Epoch 18 | Loss: 0.1964 (Rec: 0.1916, Con: 0.0488) | Val AUC: 0.7546 | Gate: N/A | Precision@5: 0.3041 | Recall@5: 0.2249 | NDCG@5: 0.3552 | Hit@5: 0.7056 | Precision@10: 0.2596 | Recall@10: 0.3582 | NDCG@10: 0.3773 | Hit@10: 0.8178 | Precision@20: 0.2064 | Recall@20: 0.5246 | NDCG@20: 0.4225 | Hit@20: 0.8982 | MAP: 0.3188 | MRR: 0.5231
2025-11-23 11:08:42,787 | INFO | Epoch 19 | Loss: 0.1910 (Rec: 0.1862, Con: 0.0481) | Val AUC: 0.7547 | Gate: N/A | Precision@5: 0.3047 | Recall@5: 0.2269 | NDCG@5: 0.3578 | Hit@5: 0.7099 | Precision@10: 0.2591 | Recall@10: 0.3579 | NDCG@10: 0.3783 | Hit@10: 0.8146 | Precision@20: 0.2049 | Recall@20: 0.5201 | NDCG@20: 0.4218 | Hit@20: 0.8932 | MAP: 0.3195 | MRR: 0.5279
2025-11-23 11:10:41,213 | INFO | Epoch 20 | Loss: 0.1901 (Rec: 0.1852, Con: 0.0486) | Val AUC: 0.7543 | Gate: N/A | Precision@5: 0.3035 | Recall@5: 0.2262 | NDCG@5: 0.3542 | Hit@5: 0.7103 | Precision@10: 0.2556 | Recall@10: 0.3543 | NDCG@10: 0.3730 | Hit@10: 0.8165 | Precision@20: 0.2040 | Recall@20: 0.5197 | NDCG@20: 0.4182 | Hit@20: 0.8936 | MAP: 0.3159 | MRR: 0.5187
2025-11-23 11:12:38,278 | INFO | Epoch 21 | Loss: 0.1890 (Rec: 0.1842, Con: 0.0479) | Val AUC: 0.7539 | Gate: N/A | Precision@5: 0.3025 | Recall@5: 0.2249 | NDCG@5: 0.3530 | Hit@5: 0.7101 | Precision@10: 0.2567 | Recall@10: 0.3544 | NDCG@10: 0.3733 | Hit@10: 0.8150 | Precision@20: 0.2037 | Recall@20: 0.5187 | NDCG@20: 0.4177 | Hit@20: 0.8948 | MAP: 0.3155 | MRR: 0.5199
2025-11-23 11:14:42,004 | INFO | Epoch 22 | Loss: 0.1863 (Rec: 0.1815, Con: 0.0488) | Val AUC: 0.7542 | Gate: N/A | Precision@5: 0.2990 | Recall@5: 0.2199 | NDCG@5: 0.3474 | Hit@5: 0.7011 | Precision@10: 0.2549 | Recall@10: 0.3520 | NDCG@10: 0.3688 | Hit@10: 0.8131 | Precision@20: 0.2024 | Recall@20: 0.5151 | NDCG@20: 0.4130 | Hit@20: 0.8955 | MAP: 0.3119 | MRR: 0.5121
2025-11-23 11:16:35,347 | INFO | Epoch 23 | Loss: 0.1858 (Rec: 0.1810, Con: 0.0482) | Val AUC: 0.7541 | Gate: N/A | Precision@5: 0.3010 | Recall@5: 0.2229 | NDCG@5: 0.3521 | Hit@5: 0.7077 | Precision@10: 0.2539 | Recall@10: 0.3504 | NDCG@10: 0.3705 | Hit@10: 0.8145 | Precision@20: 0.2018 | Recall@20: 0.5137 | NDCG@20: 0.4144 | Hit@20: 0.8892 | MAP: 0.3131 | MRR: 0.5188
2025-11-23 11:18:27,998 | INFO | Epoch 24 | Loss: 0.1854 (Rec: 0.1805, Con: 0.0487) | Val AUC: 0.7542 | Gate: N/A | Precision@5: 0.2980 | Recall@5: 0.2222 | NDCG@5: 0.3482 | Hit@5: 0.7020 | Precision@10: 0.2526 | Recall@10: 0.3491 | NDCG@10: 0.3677 | Hit@10: 0.8131 | Precision@20: 0.2016 | Recall@20: 0.5120 | NDCG@20: 0.4121 | Hit@20: 0.8885 | MAP: 0.3117 | MRR: 0.5141
2025-11-23 11:20:20,803 | INFO | Epoch 25 | Loss: 0.1839 (Rec: 0.1791, Con: 0.0482) | Val AUC: 0.7541 | Gate: N/A | Precision@5: 0.2984 | Recall@5: 0.2229 | NDCG@5: 0.3488 | Hit@5: 0.7068 | Precision@10: 0.2533 | Recall@10: 0.3500 | NDCG@10: 0.3691 | Hit@10: 0.8100 | Precision@20: 0.2008 | Recall@20: 0.5111 | NDCG@20: 0.4125 | Hit@20: 0.8920 | MAP: 0.3128 | MRR: 0.5156
2025-11-23 11:22:12,697 | INFO | Epoch 26 | Loss: 0.1838 (Rec: 0.1789, Con: 0.0485) | Val AUC: 0.7541 | Gate: N/A | Precision@5: 0.2964 | Recall@5: 0.2189 | NDCG@5: 0.3449 | Hit@5: 0.6990 | Precision@10: 0.2522 | Recall@10: 0.3489 | NDCG@10: 0.3655 | Hit@10: 0.8117 | Precision@20: 0.2006 | Recall@20: 0.5114 | NDCG@20: 0.4097 | Hit@20: 0.8908 | MAP: 0.3091 | MRR: 0.5101
2025-11-23 11:24:04,844 | INFO | Epoch 27 | Loss: 0.1835 (Rec: 0.1787, Con: 0.0486) | Val AUC: 0.7541 | Gate: N/A | Precision@5: 0.2955 | Recall@5: 0.2180 | NDCG@5: 0.3449 | Hit@5: 0.6959 | Precision@10: 0.2515 | Recall@10: 0.3474 | NDCG@10: 0.3653 | Hit@10: 0.8112 | Precision@20: 0.2003 | Recall@20: 0.5112 | NDCG@20: 0.4097 | Hit@20: 0.8913 | MAP: 0.3100 | MRR: 0.5116
2025-11-23 11:25:57,883 | INFO | Epoch 28 | Loss: 0.1828 (Rec: 0.1780, Con: 0.0483) | Val AUC: 0.7541 | Gate: N/A | Precision@5: 0.2955 | Recall@5: 0.2207 | NDCG@5: 0.3475 | Hit@5: 0.6983 | Precision@10: 0.2524 | Recall@10: 0.3490 | NDCG@10: 0.3685 | Hit@10: 0.8145 | Precision@20: 0.2003 | Recall@20: 0.5097 | NDCG@20: 0.4120 | Hit@20: 0.8892 | MAP: 0.3126 | MRR: 0.5160
2025-11-23 11:27:49,336 | INFO | Epoch 29 | Loss: 0.1827 (Rec: 0.1779, Con: 0.0485) | Val AUC: 0.7541 | Gate: N/A | Precision@5: 0.2944 | Recall@5: 0.2187 | NDCG@5: 0.3433 | Hit@5: 0.7028 | Precision@10: 0.2509 | Recall@10: 0.3458 | NDCG@10: 0.3638 | Hit@10: 0.8081 | Precision@20: 0.2005 | Recall@20: 0.5118 | NDCG@20: 0.4092 | Hit@20: 0.8915 | MAP: 0.3087 | MRR: 0.5090
2025-11-23 11:29:41,283 | INFO | Epoch 30 | Loss: 0.1826 (Rec: 0.1778, Con: 0.0486) | Val AUC: 0.7541 | Gate: N/A | Precision@5: 0.2975 | Recall@5: 0.2195 | NDCG@5: 0.3484 | Hit@5: 0.6996 | Precision@10: 0.2525 | Recall@10: 0.3500 | NDCG@10: 0.3685 | Hit@10: 0.8091 | Precision@20: 0.2007 | Recall@20: 0.5112 | NDCG@20: 0.4118 | Hit@20: 0.8908 | MAP: 0.3116 | MRR: 0.5169
