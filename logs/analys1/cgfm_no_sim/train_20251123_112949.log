2025-11-23 11:29:49,612 | INFO | Logging to: logs\cgfm_no_sim\train_20251123_112949.log
2025-11-23 11:29:49,613 | INFO | Using device: cuda
2025-11-23 11:29:49,613 | INFO | Arguments: {'train_csv': 'data\\train_val_test_dir\\train.csv', 'val_csv': 'data\\train_val_test_dir\\val.csv', 'all_csv': 'data\\train_val_test_dir\\all_ratings.csv', 'text_features': 'feature_output\\movie_text_features_20251103_1457.npz', 'img_features': 'feature_output\\movie_img_features_20251103_1457.npz', 'batch_size': 64, 'epochs': 30, 'lr': 0.0005, 'user_emb_dim': 64, 'proj_hidden_dim': 512, 'proj_dim': 512, 'vector_gate': False, 'lambda_contrast': 0.1, 'topk': [5, 10, 20], 'sample_neg': 100, 'topk_max_users': 0, 'no_scheduler': False, 'log_name': 'cgfm_no_sim', 'device': None, 'no_gate': False, 'no_sim': True, 'no_interaction': False}
2025-11-23 11:31:47,622 | INFO | Epoch 01 | Loss: 1.6680 (Rec: 1.2618, Con: 4.0629) | Val AUC: 0.7249 | Gate Mean: 0.4897 (Std: 0.0000) | Precision@5: 0.2371 | Recall@5: 0.1628 | NDCG@5: 0.2693 | Hit@5: 0.5542 | Precision@10: 0.2044 | Recall@10: 0.2668 | NDCG@10: 0.2855 | Hit@10: 0.6777 | Precision@20: 0.1662 | Recall@20: 0.4169 | NDCG@20: 0.3268 | Hit@20: 0.7934 | MAP: 0.2560 | MRR: 0.4096
2025-11-23 11:31:47,638 | INFO | Saved best model to model\best_model_cgfm_no_sim.pth
2025-11-23 11:33:44,738 | INFO | Epoch 02 | Loss: 0.6630 (Rec: 0.5682, Con: 0.9483) | Val AUC: 0.7856 | Gate Mean: 0.3656 (Std: 0.0171) | Precision@5: 0.2297 | Recall@5: 0.1594 | NDCG@5: 0.2572 | Hit@5: 0.5476 | Precision@10: 0.2108 | Recall@10: 0.2780 | NDCG@10: 0.2856 | Hit@10: 0.6867 | Precision@20: 0.1797 | Recall@20: 0.4488 | NDCG@20: 0.3375 | Hit@20: 0.8103 | MAP: 0.2630 | MRR: 0.3926
2025-11-23 11:33:44,755 | INFO | Saved best model to model\best_model_cgfm_no_sim.pth
2025-11-23 11:35:43,950 | INFO | Epoch 03 | Loss: 0.5255 (Rec: 0.5151, Con: 0.1038) | Val AUC: 0.7945 | Gate Mean: 0.3393 (Std: 0.0149) | Precision@5: 0.2686 | Recall@5: 0.1929 | NDCG@5: 0.3050 | Hit@5: 0.6206 | Precision@10: 0.2398 | Recall@10: 0.3249 | NDCG@10: 0.3337 | Hit@10: 0.7487 | Precision@20: 0.1987 | Recall@20: 0.5004 | NDCG@20: 0.3859 | Hit@20: 0.8480 | MAP: 0.2994 | MRR: 0.4502
2025-11-23 11:35:43,967 | INFO | Saved best model to model\best_model_cgfm_no_sim.pth
2025-11-23 11:37:43,787 | INFO | Epoch 04 | Loss: 0.4881 (Rec: 0.4795, Con: 0.0857) | Val AUC: 0.7957 | Gate Mean: 0.3356 (Std: 0.0224) | Precision@5: 0.2835 | Recall@5: 0.2052 | NDCG@5: 0.3247 | Hit@5: 0.6454 | Precision@10: 0.2520 | Recall@10: 0.3440 | NDCG@10: 0.3548 | Hit@10: 0.7762 | Precision@20: 0.2061 | Recall@20: 0.5207 | NDCG@20: 0.4065 | Hit@20: 0.8699 | MAP: 0.3146 | MRR: 0.4765
2025-11-23 11:37:43,803 | INFO | Saved best model to model\best_model_cgfm_no_sim.pth
###2025-11-23 11:39:40,172 | INFO | Epoch 05 | Loss: 0.4537 (Rec: 0.4459, Con: 0.0790) | Val AUC: 0.7915 | Gate Mean: 0.3150 (Std: 0.0178) | Precision@5: 0.3054 | Recall@5: 0.2236 | NDCG@5: 0.3535 | Hit@5: 0.6826 | Precision@10: 0.2638 | Recall@10: 0.3611 | NDCG@10: 0.3784 | Hit@10: 0.7949 | Precision@20: 0.2120 | Recall@20: 0.5384 | NDCG@20: 0.4285 | Hit@20: 0.8844 | MAP: 0.3315 | MRR: 0.5114
2025-11-23 11:41:37,274 | INFO | Epoch 06 | Loss: 0.4202 (Rec: 0.4127, Con: 0.0748) | Val AUC: 0.7835 | Gate Mean: 0.2740 (Std: 0.0118) | Precision@5: 0.3013 | Recall@5: 0.2217 | NDCG@5: 0.3478 | Hit@5: 0.6867 | Precision@10: 0.2609 | Recall@10: 0.3573 | NDCG@10: 0.3731 | Hit@10: 0.7982 | Precision@20: 0.2111 | Recall@20: 0.5333 | NDCG@20: 0.4237 | Hit@20: 0.8842 | MAP: 0.3252 | MRR: 0.5045
2025-11-23 11:43:33,688 | INFO | Epoch 07 | Loss: 0.3882 (Rec: 0.3810, Con: 0.0728) | Val AUC: 0.7798 | Gate Mean: 0.2813 (Std: 0.0211) | Precision@5: 0.3033 | Recall@5: 0.2237 | NDCG@5: 0.3507 | Hit@5: 0.6963 | Precision@10: 0.2601 | Recall@10: 0.3560 | NDCG@10: 0.3734 | Hit@10: 0.8046 | Precision@20: 0.2080 | Recall@20: 0.5269 | NDCG@20: 0.4210 | Hit@20: 0.8875 | MAP: 0.3212 | MRR: 0.5110
2025-11-23 11:45:29,596 | INFO | Epoch 08 | Loss: 0.3251 (Rec: 0.3188, Con: 0.0633) | Val AUC: 0.7746 | Gate Mean: 0.2986 (Std: 0.0228) | Precision@5: 0.3103 | Recall@5: 0.2274 | NDCG@5: 0.3581 | Hit@5: 0.7044 | Precision@10: 0.2661 | Recall@10: 0.3622 | NDCG@10: 0.3816 | Hit@10: 0.8139 | Precision@20: 0.2107 | Recall@20: 0.5321 | NDCG@20: 0.4281 | Hit@20: 0.8911 | MAP: 0.3274 | MRR: 0.5178
2025-11-23 11:47:25,884 | INFO | Epoch 09 | Loss: 0.3029 (Rec: 0.2966, Con: 0.0629) | Val AUC: 0.7686 | Gate Mean: 0.3070 (Std: 0.0226) | Precision@5: 0.3092 | Recall@5: 0.2278 | NDCG@5: 0.3578 | Hit@5: 0.7072 | Precision@10: 0.2636 | Recall@10: 0.3640 | NDCG@10: 0.3805 | Hit@10: 0.8209 | Precision@20: 0.2093 | Recall@20: 0.5304 | NDCG@20: 0.4263 | Hit@20: 0.8925 | MAP: 0.3241 | MRR: 0.5193
2025-11-23 11:49:21,862 | INFO | Epoch 10 | Loss: 0.2858 (Rec: 0.2795, Con: 0.0624) | Val AUC: 0.7640 | Gate Mean: 0.3195 (Std: 0.0287) | Precision@5: 0.3078 | Recall@5: 0.2277 | NDCG@5: 0.3585 | Hit@5: 0.7085 | Precision@10: 0.2621 | Recall@10: 0.3594 | NDCG@10: 0.3800 | Hit@10: 0.8183 | Precision@20: 0.2080 | Recall@20: 0.5256 | NDCG@20: 0.4252 | Hit@20: 0.8939 | MAP: 0.3229 | MRR: 0.5230
2025-11-23 11:51:19,002 | INFO | Epoch 11 | Loss: 0.2491 (Rec: 0.2432, Con: 0.0587) | Val AUC: 0.7630 | Gate Mean: 0.3334 (Std: 0.0349) | Precision@5: 0.3127 | Recall@5: 0.2313 | NDCG@5: 0.3612 | Hit@5: 0.7118 | Precision@10: 0.2645 | Recall@10: 0.3619 | NDCG@10: 0.3818 | Hit@10: 0.8202 | Precision@20: 0.2100 | Recall@20: 0.5303 | NDCG@20: 0.4277 | Hit@20: 0.8963 | MAP: 0.3242 | MRR: 0.5209
2025-11-23 11:53:16,164 | INFO | Epoch 12 | Loss: 0.2398 (Rec: 0.2339, Con: 0.0587) | Val AUC: 0.7593 | Gate Mean: 0.3344 (Std: 0.0342) | Precision@5: 0.3096 | Recall@5: 0.2273 | NDCG@5: 0.3591 | Hit@5: 0.7058 | Precision@10: 0.2632 | Recall@10: 0.3581 | NDCG@10: 0.3803 | Hit@10: 0.8169 | Precision@20: 0.2075 | Recall@20: 0.5238 | NDCG@20: 0.4246 | Hit@20: 0.8960 | MAP: 0.3225 | MRR: 0.5224
2025-11-23 11:55:12,519 | INFO | Epoch 13 | Loss: 0.2320 (Rec: 0.2261, Con: 0.0587) | Val AUC: 0.7582 | Gate Mean: 0.3623 (Std: 0.0401) | Precision@5: 0.3102 | Recall@5: 0.2295 | NDCG@5: 0.3605 | Hit@5: 0.7127 | Precision@10: 0.2631 | Recall@10: 0.3607 | NDCG@10: 0.3814 | Hit@10: 0.8226 | Precision@20: 0.2071 | Recall@20: 0.5247 | NDCG@20: 0.4251 | Hit@20: 0.8951 | MAP: 0.3224 | MRR: 0.5242
2025-11-23 11:57:08,699 | INFO | Epoch 14 | Loss: 0.2120 (Rec: 0.2064, Con: 0.0569) | Val AUC: 0.7584 | Gate Mean: 0.3774 (Std: 0.0430) | Precision@5: 0.3087 | Recall@5: 0.2272 | NDCG@5: 0.3585 | Hit@5: 0.7099 | Precision@10: 0.2639 | Recall@10: 0.3613 | NDCG@10: 0.3809 | Hit@10: 0.8235 | Precision@20: 0.2075 | Recall@20: 0.5223 | NDCG@20: 0.4237 | Hit@20: 0.8927 | MAP: 0.3209 | MRR: 0.5225
2025-11-23 11:59:04,931 | INFO | Epoch 15 | Loss: 0.2079 (Rec: 0.2022, Con: 0.0575) | Val AUC: 0.7566 | Gate Mean: 0.3850 (Std: 0.0435) | Precision@5: 0.3078 | Recall@5: 0.2267 | NDCG@5: 0.3569 | Hit@5: 0.7122 | Precision@10: 0.2620 | Recall@10: 0.3594 | NDCG@10: 0.3786 | Hit@10: 0.8217 | Precision@20: 0.2063 | Recall@20: 0.5223 | NDCG@20: 0.4222 | Hit@20: 0.8963 | MAP: 0.3198 | MRR: 0.5210
2025-11-23 12:01:01,562 | INFO | Epoch 16 | Loss: 0.2042 (Rec: 0.1984, Con: 0.0579) | Val AUC: 0.7561 | Gate Mean: 0.4198 (Std: 0.0470) | Precision@5: 0.3101 | Recall@5: 0.2278 | NDCG@5: 0.3585 | Hit@5: 0.7155 | Precision@10: 0.2619 | Recall@10: 0.3582 | NDCG@10: 0.3784 | Hit@10: 0.8202 | Precision@20: 0.2049 | Recall@20: 0.5183 | NDCG@20: 0.4203 | Hit@20: 0.8918 | MAP: 0.3188 | MRR: 0.5207
2025-11-23 12:02:57,754 | INFO | Epoch 17 | Loss: 0.1936 (Rec: 0.1879, Con: 0.0566) | Val AUC: 0.7554 | Gate Mean: 0.4575 (Std: 0.0501) | Precision@5: 0.3072 | Recall@5: 0.2265 | NDCG@5: 0.3568 | Hit@5: 0.7106 | Precision@10: 0.2601 | Recall@10: 0.3550 | NDCG@10: 0.3766 | Hit@10: 0.8152 | Precision@20: 0.2046 | Recall@20: 0.5173 | NDCG@20: 0.4198 | Hit@20: 0.8943 | MAP: 0.3183 | MRR: 0.5225
2025-11-23 12:04:54,255 | INFO | Epoch 18 | Loss: 0.1916 (Rec: 0.1859, Con: 0.0568) | Val AUC: 0.7547 | Gate Mean: 0.4755 (Std: 0.0519) | Precision@5: 0.3062 | Recall@5: 0.2269 | NDCG@5: 0.3575 | Hit@5: 0.7129 | Precision@10: 0.2588 | Recall@10: 0.3543 | NDCG@10: 0.3769 | Hit@10: 0.8186 | Precision@20: 0.2039 | Recall@20: 0.5144 | NDCG@20: 0.4194 | Hit@20: 0.8894 | MAP: 0.3185 | MRR: 0.5237
2025-11-23 12:06:53,466 | INFO | Epoch 19 | Loss: 0.1897 (Rec: 0.1840, Con: 0.0569) | Val AUC: 0.7552 | Gate Mean: 0.4789 (Std: 0.0525) | Precision@5: 0.3040 | Recall@5: 0.2222 | NDCG@5: 0.3529 | Hit@5: 0.7025 | Precision@10: 0.2586 | Recall@10: 0.3547 | NDCG@10: 0.3743 | Hit@10: 0.8141 | Precision@20: 0.2035 | Recall@20: 0.5127 | NDCG@20: 0.4161 | Hit@20: 0.8901 | MAP: 0.3161 | MRR: 0.5172
2025-11-23 12:08:58,720 | INFO | Epoch 20 | Loss: 0.1841 (Rec: 0.1784, Con: 0.0569) | Val AUC: 0.7545 | Gate Mean: 0.5008 (Std: 0.0534) | Precision@5: 0.3009 | Recall@5: 0.2229 | NDCG@5: 0.3503 | Hit@5: 0.7020 | Precision@10: 0.2566 | Recall@10: 0.3521 | NDCG@10: 0.3718 | Hit@10: 0.8153 | Precision@20: 0.2025 | Recall@20: 0.5124 | NDCG@20: 0.4148 | Hit@20: 0.8918 | MAP: 0.3150 | MRR: 0.5156
2025-11-23 12:11:00,756 | INFO | Epoch 21 | Loss: 0.1831 (Rec: 0.1775, Con: 0.0569) | Val AUC: 0.7544 | Gate Mean: 0.5062 (Std: 0.0544) | Precision@5: 0.2997 | Recall@5: 0.2217 | NDCG@5: 0.3482 | Hit@5: 0.7008 | Precision@10: 0.2555 | Recall@10: 0.3495 | NDCG@10: 0.3693 | Hit@10: 0.8136 | Precision@20: 0.2017 | Recall@20: 0.5095 | NDCG@20: 0.4121 | Hit@20: 0.8870 | MAP: 0.3126 | MRR: 0.5112
2025-11-23 12:13:02,267 | INFO | Epoch 22 | Loss: 0.1822 (Rec: 0.1765, Con: 0.0574) | Val AUC: 0.7538 | Gate Mean: 0.5079 (Std: 0.0539) | Precision@5: 0.3034 | Recall@5: 0.2231 | NDCG@5: 0.3510 | Hit@5: 0.7070 | Precision@10: 0.2557 | Recall@10: 0.3515 | NDCG@10: 0.3704 | Hit@10: 0.8138 | Precision@20: 0.2014 | Recall@20: 0.5094 | NDCG@20: 0.4124 | Hit@20: 0.8898 | MAP: 0.3126 | MRR: 0.5150
2025-11-23 12:15:08,269 | INFO | Epoch 23 | Loss: 0.1793 (Rec: 0.1736, Con: 0.0568) | Val AUC: 0.7537 | Gate Mean: 0.5252 (Std: 0.0548) | Precision@5: 0.2985 | Recall@5: 0.2199 | NDCG@5: 0.3460 | Hit@5: 0.6956 | Precision@10: 0.2541 | Recall@10: 0.3483 | NDCG@10: 0.3669 | Hit@10: 0.8103 | Precision@20: 0.2012 | Recall@20: 0.5103 | NDCG@20: 0.4106 | Hit@20: 0.8917 | MAP: 0.3111 | MRR: 0.5081
2025-11-23 12:17:12,394 | INFO | Epoch 24 | Loss: 0.1789 (Rec: 0.1731, Con: 0.0573) | Val AUC: 0.7537 | Gate Mean: 0.5309 (Std: 0.0549) | Precision@5: 0.2966 | Recall@5: 0.2176 | NDCG@5: 0.3444 | Hit@5: 0.6976 | Precision@10: 0.2522 | Recall@10: 0.3463 | NDCG@10: 0.3654 | Hit@10: 0.8077 | Precision@20: 0.1999 | Recall@20: 0.5061 | NDCG@20: 0.4083 | Hit@20: 0.8899 | MAP: 0.3095 | MRR: 0.5105
2025-11-23 12:19:17,081 | INFO | Epoch 25 | Loss: 0.1784 (Rec: 0.1727, Con: 0.0569) | Val AUC: 0.7536 | Gate Mean: 0.5351 (Std: 0.0554) | Precision@5: 0.2958 | Recall@5: 0.2179 | NDCG@5: 0.3438 | Hit@5: 0.6997 | Precision@10: 0.2530 | Recall@10: 0.3475 | NDCG@10: 0.3654 | Hit@10: 0.8108 | Precision@20: 0.2005 | Recall@20: 0.5091 | NDCG@20: 0.4092 | Hit@20: 0.8891 | MAP: 0.3094 | MRR: 0.5101
2025-11-23 12:21:24,995 | INFO | Epoch 26 | Loss: 0.1769 (Rec: 0.1712, Con: 0.0574) | Val AUC: 0.7535 | Gate Mean: 0.5324 (Std: 0.0552) | Precision@5: 0.2963 | Recall@5: 0.2189 | NDCG@5: 0.3438 | Hit@5: 0.7002 | Precision@10: 0.2537 | Recall@10: 0.3488 | NDCG@10: 0.3660 | Hit@10: 0.8138 | Precision@20: 0.2006 | Recall@20: 0.5092 | NDCG@20: 0.4095 | Hit@20: 0.8894 | MAP: 0.3096 | MRR: 0.5091
2025-11-23 12:23:30,268 | INFO | Epoch 27 | Loss: 0.1767 (Rec: 0.1710, Con: 0.0573) | Val AUC: 0.7534 | Gate Mean: 0.5373 (Std: 0.0555) | Precision@5: 0.2973 | Recall@5: 0.2190 | NDCG@5: 0.3458 | Hit@5: 0.6963 | Precision@10: 0.2534 | Recall@10: 0.3477 | NDCG@10: 0.3669 | Hit@10: 0.8098 | Precision@20: 0.2003 | Recall@20: 0.5069 | NDCG@20: 0.4096 | Hit@20: 0.8873 | MAP: 0.3105 | MRR: 0.5119
2025-11-23 12:25:40,120 | INFO | Epoch 28 | Loss: 0.1764 (Rec: 0.1707, Con: 0.0570) | Val AUC: 0.7533 | Gate Mean: 0.5428 (Std: 0.0557) | Precision@5: 0.2965 | Recall@5: 0.2186 | NDCG@5: 0.3448 | Hit@5: 0.6997 | Precision@10: 0.2525 | Recall@10: 0.3457 | NDCG@10: 0.3655 | Hit@10: 0.8098 | Precision@20: 0.2001 | Recall@20: 0.5084 | NDCG@20: 0.4095 | Hit@20: 0.8903 | MAP: 0.3099 | MRR: 0.5118
2025-11-23 12:27:46,532 | INFO | Epoch 29 | Loss: 0.1757 (Rec: 0.1700, Con: 0.0573) | Val AUC: 0.7533 | Gate Mean: 0.5411 (Std: 0.0556) | Precision@5: 0.2928 | Recall@5: 0.2180 | NDCG@5: 0.3420 | Hit@5: 0.6966 | Precision@10: 0.2520 | Recall@10: 0.3451 | NDCG@10: 0.3644 | Hit@10: 0.8084 | Precision@20: 0.1999 | Recall@20: 0.5066 | NDCG@20: 0.4080 | Hit@20: 0.8911 | MAP: 0.3090 | MRR: 0.5088
2025-11-23 12:29:52,950 | INFO | Epoch 30 | Loss: 0.1755 (Rec: 0.1699, Con: 0.0567) | Val AUC: 0.7532 | Gate Mean: 0.5437 (Std: 0.0556) | Precision@5: 0.2942 | Recall@5: 0.2166 | NDCG@5: 0.3421 | Hit@5: 0.6942 | Precision@10: 0.2515 | Recall@10: 0.3459 | NDCG@10: 0.3641 | Hit@10: 0.8100 | Precision@20: 0.1990 | Recall@20: 0.5045 | NDCG@20: 0.4068 | Hit@20: 0.8889 | MAP: 0.3083 | MRR: 0.5088
